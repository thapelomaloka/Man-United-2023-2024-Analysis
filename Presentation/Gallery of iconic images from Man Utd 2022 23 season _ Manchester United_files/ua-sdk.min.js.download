/*! UA-Web-Push: da02ce9:1716543667283 */!function(){"use strict";var t,e,n={5946:function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},9033:function(t){function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}},8424:function(t){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},2924:function(t){function e(n){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=e=function(t){return typeof t}:t.exports=e=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(n)}t.exports=e},1656:function(t,e,n){var r=n(8424),i=r(n(5946)),o=r(n(9033));var a=function(){function t(){(0,i.default)(this,t),this._acquired=!1,this._waitingResolvers=[]}return(0,o.default)(t,[{key:"acquired",get:function(){return this._acquired}},{key:"acquireAsync",value:function(){var t=this;return this._acquired?new Promise((function(e){t._waitingResolvers.push(e)})):(this._acquired=!0,Promise.resolve())}},{key:"tryAcquire",value:function(){return!this._acquired&&(this._acquired=!0,!0)}},{key:"release",value:function(){if(!this._acquired)throw new Error("Cannot release an unacquired lock");this._waitingResolvers.length>0?this._waitingResolvers.shift()():this._acquired=!1}}]),t}();e.Z=a},4314:function(t,e,n){var r,i,o;t=n.nmd(t);var a,s=n(8424)(n(2924));a=function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==(0,s.default)(t)&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=90)}({17:function(t,e,n){e.__esModule=!0,e.default=void 0;var r=n(18),i=function(){function t(){}return t.getFirstMatch=function(t,e){var n=e.match(t);return n&&n.length>0&&n[1]||""},t.getSecondMatch=function(t,e){var n=e.match(t);return n&&n.length>1&&n[2]||""},t.matchAndReturnConst=function(t,e,n){if(t.test(e))return n},t.getWindowsVersionName=function(t){switch(t){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},t.getMacOSVersionName=function(t){var e=t.split(".").splice(0,2).map((function(t){return parseInt(t,10)||0}));if(e.push(0),10===e[0])switch(e[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},t.getAndroidVersionName=function(t){var e=t.split(".").splice(0,2).map((function(t){return parseInt(t,10)||0}));if(e.push(0),!(1===e[0]&&e[1]<5))return 1===e[0]&&e[1]<6?"Cupcake":1===e[0]&&e[1]>=6?"Donut":2===e[0]&&e[1]<2?"Eclair":2===e[0]&&2===e[1]?"Froyo":2===e[0]&&e[1]>2?"Gingerbread":3===e[0]?"Honeycomb":4===e[0]&&e[1]<1?"Ice Cream Sandwich":4===e[0]&&e[1]<4?"Jelly Bean":4===e[0]&&e[1]>=4?"KitKat":5===e[0]?"Lollipop":6===e[0]?"Marshmallow":7===e[0]?"Nougat":8===e[0]?"Oreo":9===e[0]?"Pie":void 0},t.getVersionPrecision=function(t){return t.split(".").length},t.compareVersions=function(e,n,r){void 0===r&&(r=!1);var i=t.getVersionPrecision(e),o=t.getVersionPrecision(n),a=Math.max(i,o),s=0,u=t.map([e,n],(function(e){var n=a-t.getVersionPrecision(e),r=e+new Array(n+1).join(".0");return t.map(r.split("."),(function(t){return new Array(20-t.length).join("0")+t})).reverse()}));for(r&&(s=a-Math.min(i,o)),a-=1;a>=s;){if(u[0][a]>u[1][a])return 1;if(u[0][a]===u[1][a]){if(a===s)return 0;a-=1}else if(u[0][a]<u[1][a])return-1}},t.map=function(t,e){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(t,e);for(n=0;n<t.length;n+=1)r.push(e(t[n]));return r},t.find=function(t,e){var n,r;if(Array.prototype.find)return Array.prototype.find.call(t,e);for(n=0,r=t.length;n<r;n+=1){var i=t[n];if(e(i,n))return i}},t.assign=function(t){for(var e,n,r=t,i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[t].concat(o));var u=function(){var t=o[e];"object"==(0,s.default)(t)&&null!==t&&Object.keys(t).forEach((function(e){r[e]=t[e]}))};for(e=0,n=o.length;e<n;e+=1)u();return t},t.getBrowserAlias=function(t){return r.BROWSER_ALIASES_MAP[t]},t.getBrowserTypeByAlias=function(t){return r.BROWSER_MAP[t]||""},t}();e.default=i,t.exports=e.default},18:function(t,e,n){e.__esModule=!0,e.ENGINE_MAP=e.OS_MAP=e.PLATFORMS_MAP=e.BROWSER_MAP=e.BROWSER_ALIASES_MAP=void 0,e.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},e.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},e.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},e.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},e.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(91))&&r.__esModule?r:{default:r},o=n(18);function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(){function t(){}var e,n;return t.getParser=function(t,e){if(void 0===e&&(e=!1),"string"!=typeof t)throw new Error("UserAgent should be a string");return new i.default(t,e)},t.parse=function(t){return new i.default(t).getResult()},e=t,(n=[{key:"BROWSER_MAP",get:function(){return o.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return o.ENGINE_MAP}},{key:"OS_MAP",get:function(){return o.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return o.PLATFORMS_MAP}}])&&a(e,n),t}();e.default=s,t.exports=e.default},91:function(t,e,n){e.__esModule=!0,e.default=void 0;var r=c(n(92)),i=c(n(93)),o=c(n(94)),a=c(n(95)),u=c(n(17));function c(t){return t&&t.__esModule?t:{default:t}}var l=function(){function t(t,e){if(void 0===e&&(e=!1),null==t||""===t)throw new Error("UserAgent parameter can't be empty");this._ua=t,this.parsedResult={},!0!==e&&this.parse()}var e=t.prototype;return e.getUA=function(){return this._ua},e.test=function(t){return t.test(this._ua)},e.parseBrowser=function(){var t=this;this.parsedResult.browser={};var e=u.default.find(r.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser},e.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},e.getBrowserName=function(t){return t?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},e.getBrowserVersion=function(){return this.getBrowser().version},e.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},e.parseOS=function(){var t=this;this.parsedResult.os={};var e=u.default.find(i.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os},e.getOSName=function(t){var e=this.getOS().name;return t?String(e).toLowerCase()||"":e||""},e.getOSVersion=function(){return this.getOS().version},e.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},e.getPlatformType=function(t){void 0===t&&(t=!1);var e=this.getPlatform().type;return t?String(e).toLowerCase()||"":e||""},e.parsePlatform=function(){var t=this;this.parsedResult.platform={};var e=u.default.find(o.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform},e.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},e.getEngineName=function(t){return t?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},e.parseEngine=function(){var t=this;this.parsedResult.engine={};var e=u.default.find(a.default,(function(e){if("function"==typeof e.test)return e.test(t);if(e.test instanceof Array)return e.test.some((function(e){return t.test(e)}));throw new Error("Browser's test function is not valid")}));return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine},e.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},e.getResult=function(){return u.default.assign({},this.parsedResult)},e.satisfies=function(t){var e=this,n={},r=0,i={},o=0;if(Object.keys(t).forEach((function(e){var a=t[e];"string"==typeof a?(i[e]=a,o+=1):"object"==(0,s.default)(a)&&(n[e]=a,r+=1)})),r>0){var a=Object.keys(n),c=u.default.find(a,(function(t){return e.isOS(t)}));if(c){var l=this.satisfies(n[c]);if(void 0!==l)return l}var f=u.default.find(a,(function(t){return e.isPlatform(t)}));if(f){var p=this.satisfies(n[f]);if(void 0!==p)return p}}if(o>0){var d=Object.keys(i),h=u.default.find(d,(function(t){return e.isBrowser(t,!0)}));if(void 0!==h)return this.compareVersion(i[h])}},e.isBrowser=function(t,e){void 0===e&&(e=!1);var n=this.getBrowserName().toLowerCase(),r=t.toLowerCase(),i=u.default.getBrowserTypeByAlias(r);return e&&i&&(r=i.toLowerCase()),r===n},e.compareVersion=function(t){var e=[0],n=t,r=!1,i=this.getBrowserVersion();if("string"==typeof i)return">"===t[0]||"<"===t[0]?(n=t.substr(1),"="===t[1]?(r=!0,n=t.substr(2)):e=[],">"===t[0]?e.push(1):e.push(-1)):"="===t[0]?n=t.substr(1):"~"===t[0]&&(r=!0,n=t.substr(1)),e.indexOf(u.default.compareVersions(i,n,r))>-1},e.isOS=function(t){return this.getOSName(!0)===String(t).toLowerCase()},e.isPlatform=function(t){return this.getPlatformType(!0)===String(t).toLowerCase()},e.isEngine=function(t){return this.getEngineName(!0)===String(t).toLowerCase()},e.is=function(t){return this.isBrowser(t)||this.isOS(t)||this.isPlatform(t)},e.some=function(t){var e=this;return void 0===t&&(t=[]),t.some((function(t){return e.is(t)}))},t}();e.default=l,t.exports=e.default},92:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=/version\/(\d+(\.?_?\d+)+)/i,a=[{test:[/googlebot/i],describe:function(t){var e={name:"Googlebot"},n=i.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/opera/i],describe:function(t){var e={name:"Opera"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/opr\/|opios/i],describe:function(t){var e={name:"Opera"},n=i.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/SamsungBrowser/i],describe:function(t){var e={name:"Samsung Internet for Android"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Whale/i],describe:function(t){var e={name:"NAVER Whale Browser"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/MZBrowser/i],describe:function(t){var e={name:"MZ Browser"},n=i.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/focus/i],describe:function(t){var e={name:"Focus"},n=i.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/swing/i],describe:function(t){var e={name:"Swing"},n=i.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/coast/i],describe:function(t){var e={name:"Opera Coast"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/yabrowser/i],describe:function(t){var e={name:"Yandex Browser"},n=i.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/ucbrowser/i],describe:function(t){var e={name:"UC Browser"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/Maxthon|mxios/i],describe:function(t){var e={name:"Maxthon"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/epiphany/i],describe:function(t){var e={name:"Epiphany"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/puffin/i],describe:function(t){var e={name:"Puffin"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sleipnir/i],describe:function(t){var e={name:"Sleipnir"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/k-meleon/i],describe:function(t){var e={name:"K-Meleon"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/micromessenger/i],describe:function(t){var e={name:"WeChat"},n=i.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/qqbrowser/i],describe:function(t){var e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},n=i.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/msie|trident/i],describe:function(t){var e={name:"Internet Explorer"},n=i.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/\sedg\//i],describe:function(t){var e={name:"Microsoft Edge"},n=i.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/edg([ea]|ios)/i],describe:function(t){var e={name:"Microsoft Edge"},n=i.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/vivaldi/i],describe:function(t){var e={name:"Vivaldi"},n=i.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/seamonkey/i],describe:function(t){var e={name:"SeaMonkey"},n=i.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/sailfish/i],describe:function(t){var e={name:"Sailfish"},n=i.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return n&&(e.version=n),e}},{test:[/silk/i],describe:function(t){var e={name:"Amazon Silk"},n=i.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/phantom/i],describe:function(t){var e={name:"PhantomJS"},n=i.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/slimerjs/i],describe:function(t){var e={name:"SlimerJS"},n=i.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(t){var e={name:"BlackBerry"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(web|hpw)[o0]s/i],describe:function(t){var e={name:"WebOS Browser"},n=i.default.getFirstMatch(o,t)||i.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/bada/i],describe:function(t){var e={name:"Bada"},n=i.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/tizen/i],describe:function(t){var e={name:"Tizen"},n=i.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/qupzilla/i],describe:function(t){var e={name:"QupZilla"},n=i.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/firefox|iceweasel|fxios/i],describe:function(t){var e={name:"Firefox"},n=i.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/electron/i],describe:function(t){var e={name:"Electron"},n=i.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/chromium/i],describe:function(t){var e={name:"Chromium"},n=i.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/chrome|crios|crmo/i],describe:function(t){var e={name:"Chrome"},n=i.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/GSA/i],describe:function(t){var e={name:"Google Search"},n=i.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:function(t){var e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe:function(t){var e={name:"Android Browser"},n=i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/playstation 4/i],describe:function(t){var e={name:"PlayStation 4"},n=i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/safari|applewebkit/i],describe:function(t){var e={name:"Safari"},n=i.default.getFirstMatch(o,t);return n&&(e.version=n),e}},{test:[/.*/i],describe:function(t){var e=-1!==t.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:i.default.getFirstMatch(e,t),version:i.default.getSecondMatch(e,t)}}}];e.default=a,t.exports=e.default},93:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:[/Roku\/DVP/],describe:function(t){var e=i.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:o.OS_MAP.Roku,version:e}}},{test:[/windows phone/i],describe:function(t){var e=i.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:o.OS_MAP.WindowsPhone,version:e}}},{test:[/windows /i],describe:function(t){var e=i.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),n=i.default.getWindowsVersionName(e);return{name:o.OS_MAP.Windows,version:e,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:function(t){var e=i.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return{name:o.OS_MAP.iOS,version:e}}},{test:[/macintosh/i],describe:function(t){var e=i.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),n=i.default.getMacOSVersionName(e),r={name:o.OS_MAP.MacOS,version:e};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(t){var e=i.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:o.OS_MAP.iOS,version:e}}},{test:function(t){var e=!t.test(/like android/i),n=t.test(/android/i);return e&&n},describe:function(t){var e=i.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),n=i.default.getAndroidVersionName(e),r={name:o.OS_MAP.Android,version:e};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(t){var e=i.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),n={name:o.OS_MAP.WebOS};return e&&e.length&&(n.version=e),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(t){var e=i.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||i.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||i.default.getFirstMatch(/\bbb(\d+)/i,t);return{name:o.OS_MAP.BlackBerry,version:e}}},{test:[/bada/i],describe:function(t){var e=i.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:o.OS_MAP.Bada,version:e}}},{test:[/tizen/i],describe:function(t){var e=i.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:o.OS_MAP.Tizen,version:e}}},{test:[/linux/i],describe:function(){return{name:o.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:o.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(t){var e=i.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:o.OS_MAP.PlayStation4,version:e}}}];e.default=a,t.exports=e.default},94:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(t){var e=i.default.getFirstMatch(/(can-l01)/i,t)&&"Nova",n={type:o.PLATFORMS_MAP.mobile,vendor:"Huawei"};return e&&(n.model=e),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?) Version\//],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(t){var e=t.test(/ipod|iphone/i),n=t.test(/like (ipod|iphone)/i);return e&&!n},describe:function(t){var e=i.default.getFirstMatch(/(ipod|iphone)/i,t);return{type:o.PLATFORMS_MAP.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(t){return"blackberry"===t.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(t){return"bada"===t.getBrowserName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(t){return"windows phone"===t.getBrowserName()},describe:function(){return{type:o.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(t){var e=Number(String(t.getOSVersion()).split(".")[0]);return"android"===t.getOSName(!0)&&e>=3},describe:function(){return{type:o.PLATFORMS_MAP.tablet}}},{test:function(t){return"android"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.mobile}}},{test:function(t){return"macos"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(t){return"windows"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(t){return"linux"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.desktop}}},{test:function(t){return"playstation 4"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}},{test:function(t){return"roku"===t.getOSName(!0)},describe:function(){return{type:o.PLATFORMS_MAP.tv}}}];e.default=a,t.exports=e.default},95:function(t,e,n){e.__esModule=!0,e.default=void 0;var r,i=(r=n(17))&&r.__esModule?r:{default:r},o=n(18),a=[{test:function(t){return"microsoft edge"===t.getBrowserName(!0)},describe:function(t){if(/\sedg\//i.test(t))return{name:o.ENGINE_MAP.Blink};var e=i.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:o.ENGINE_MAP.EdgeHTML,version:e}}},{test:[/trident/i],describe:function(t){var e={name:o.ENGINE_MAP.Trident},n=i.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:function(t){return t.test(/presto/i)},describe:function(t){var e={name:o.ENGINE_MAP.Presto},n=i.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:function(t){var e=t.test(/gecko/i),n=t.test(/like gecko/i);return e&&!n},describe:function(t){var e={name:o.ENGINE_MAP.Gecko},n=i.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:o.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(t){var e={name:o.ENGINE_MAP.WebKit},n=i.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return n&&(e.version=n),e}}];e.default=a,t.exports=e.default}})},"object"==(0,s.default)(e)&&"object"==(0,s.default)(t)?t.exports=a():(i=[],void 0===(o="function"==typeof(r=a)?r.apply(e,i):r)||(t.exports=o))},7690:function(t){t.exports=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=void 0,i=void 0,o=void 0,a=[];return function(){var u=function(t){return"function"==typeof t?t():t}(e),c=(new Date).getTime(),l=!r||c-r>u;r=c;for(var f=arguments.length,p=Array(f),d=0;d<f;d++)p[d]=arguments[d];if(l&&n.leading)return n.accumulate?Promise.resolve(t.call(this,[p])).then((function(t){return t[0]})):Promise.resolve(t.call.apply(t,[this].concat(p)));if(i?clearTimeout(o):i=function(){var t={};return t.promise=new Promise((function(e,n){t.resolve=e,t.reject=n})),t}(),a.push(p),o=setTimeout(s.bind(this),u),n.accumulate){var h=a.length-1;return i.promise.then((function(t){return t[h]}))}return i.promise};function s(){var e=i;clearTimeout(o),Promise.resolve(n.accumulate?t.call(this,a):t.apply(this,a[a.length-1])).then(e.resolve,e.reject),a=[],i=null}}},5397:function(t,e,n){var r=n(8424)(n(2924));Object.defineProperty(e,"__esModule",{value:!0});var i=new WeakMap,o=new WeakMap;function a(t){var e=i.get(t);return console.assert(null!=e,"'this' is expected an Event object, but got",t),e}function s(t){null==t.passiveListener?t.event.cancelable&&(t.canceled=!0,"function"==typeof t.event.preventDefault&&t.event.preventDefault()):"undefined"!=typeof console&&"function"==typeof console.error&&console.error("Unable to preventDefault inside passive event listener invocation.",t.passiveListener)}function u(t,e){i.set(this,{eventTarget:t,event:e,eventPhase:2,currentTarget:t,canceled:!1,stopped:!1,immediateStopped:!1,passiveListener:null,timeStamp:e.timeStamp||Date.now()}),Object.defineProperty(this,"isTrusted",{value:!1,enumerable:!0});for(var n=Object.keys(e),r=0;r<n.length;++r){var o=n[r];o in this||Object.defineProperty(this,o,c(o))}}function c(t){return{get:function(){return a(this).event[t]},set:function(e){a(this).event[t]=e},configurable:!0,enumerable:!0}}function l(t){return{value:function(){var e=a(this).event;return e[t].apply(e,arguments)},configurable:!0,enumerable:!0}}function f(t){if(null==t||t===Object.prototype)return u;var e=o.get(t);return null==e&&(e=function(t,e){var n=Object.keys(e);if(0===n.length)return t;function r(e,n){t.call(this,e,n)}r.prototype=Object.create(t.prototype,{constructor:{value:r,configurable:!0,writable:!0}});for(var i=0;i<n.length;++i){var o=n[i];if(!(o in t.prototype)){var a="function"==typeof Object.getOwnPropertyDescriptor(e,o).value;Object.defineProperty(r.prototype,o,a?l(o):c(o))}}return r}(f(Object.getPrototypeOf(t)),t),o.set(t,e)),e}function p(t){return a(t).immediateStopped}function d(t,e){a(t).passiveListener=e}u.prototype={get type(){return a(this).event.type},get target(){return a(this).eventTarget},get currentTarget(){return a(this).currentTarget},composedPath:function(){var t=a(this).currentTarget;return null==t?[]:[t]},get NONE(){return 0},get CAPTURING_PHASE(){return 1},get AT_TARGET(){return 2},get BUBBLING_PHASE(){return 3},get eventPhase(){return a(this).eventPhase},stopPropagation:function(){var t=a(this);t.stopped=!0,"function"==typeof t.event.stopPropagation&&t.event.stopPropagation()},stopImmediatePropagation:function(){var t=a(this);t.stopped=!0,t.immediateStopped=!0,"function"==typeof t.event.stopImmediatePropagation&&t.event.stopImmediatePropagation()},get bubbles(){return Boolean(a(this).event.bubbles)},get cancelable(){return Boolean(a(this).event.cancelable)},preventDefault:function(){s(a(this))},get defaultPrevented(){return a(this).canceled},get composed(){return Boolean(a(this).event.composed)},get timeStamp(){return a(this).timeStamp},get srcElement(){return a(this).eventTarget},get cancelBubble(){return a(this).stopped},set cancelBubble(t){if(t){var e=a(this);e.stopped=!0,"boolean"==typeof e.event.cancelBubble&&(e.event.cancelBubble=!0)}},get returnValue(){return!a(this).canceled},set returnValue(t){t||s(a(this))},initEvent:function(){}},Object.defineProperty(u.prototype,"constructor",{value:u,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.Event&&(Object.setPrototypeOf(u.prototype,window.Event.prototype),o.set(window.Event.prototype,u));var h=new WeakMap,v=3;function y(t){return null!==t&&"object"===(0,r.default)(t)}function b(t){var e=h.get(t);if(null==e)throw new TypeError("'this' is expected an EventTarget object, but got another value.");return e}function g(t,e){Object.defineProperty(t,"on".concat(e),function(t){return{get:function(){for(var e=b(this).get(t);null!=e;){if(e.listenerType===v)return e.listener;e=e.next}return null},set:function(e){"function"==typeof e||y(e)||(e=null);for(var n=b(this),r=null,i=n.get(t);null!=i;)i.listenerType===v?null!==r?r.next=i.next:null!==i.next?n.set(t,i.next):n.delete(t):r=i,i=i.next;if(null!==e){var o={listener:e,listenerType:v,passive:!1,once:!1,next:null};null===r?n.set(t,o):r.next=o}},configurable:!0,enumerable:!0}}(e))}function m(t){function e(){_.call(this)}e.prototype=Object.create(_.prototype,{constructor:{value:e,configurable:!0,writable:!0}});for(var n=0;n<t.length;++n)g(e.prototype,t[n]);return e}function _(){if(!(this instanceof _)){if(1===arguments.length&&Array.isArray(arguments[0]))return m(arguments[0]);if(arguments.length>0){for(var t=new Array(arguments.length),e=0;e<arguments.length;++e)t[e]=arguments[e];return m(t)}throw new TypeError("Cannot call a class as a function")}h.set(this,new Map)}_.prototype={addEventListener:function(t,e,n){if(null!=e){if("function"!=typeof e&&!y(e))throw new TypeError("'listener' should be a function or an object.");var r=b(this),i=y(n),o=(i?Boolean(n.capture):Boolean(n))?1:2,a={listener:e,listenerType:o,passive:i&&Boolean(n.passive),once:i&&Boolean(n.once),next:null},s=r.get(t);if(void 0!==s){for(var u=null;null!=s;){if(s.listener===e&&s.listenerType===o)return;u=s,s=s.next}u.next=a}else r.set(t,a)}},removeEventListener:function(t,e,n){if(null!=e)for(var r=b(this),i=(y(n)?Boolean(n.capture):Boolean(n))?1:2,o=null,a=r.get(t);null!=a;){if(a.listener===e&&a.listenerType===i)return void(null!==o?o.next=a.next:null!==a.next?r.set(t,a.next):r.delete(t));o=a,a=a.next}},dispatchEvent:function(t){if(null==t||"string"!=typeof t.type)throw new TypeError('"event.type" should be a string.');var e=b(this),n=t.type,r=e.get(n);if(null==r)return!0;for(var i=function(t,e){return new(f(Object.getPrototypeOf(e)))(t,e)}(this,t),o=null;null!=r;){if(r.once?null!==o?o.next=r.next:null!==r.next?e.set(n,r.next):e.delete(n):o=r,d(i,r.passive?r.listener:null),"function"==typeof r.listener)try{r.listener.call(this,i)}catch(t){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(t)}else r.listenerType!==v&&"function"==typeof r.listener.handleEvent&&r.listener.handleEvent(i);if(p(i))break;r=r.next}return d(i,null),function(t,e){a(t).eventPhase=e}(i,0),function(t,e){a(t).currentTarget=e}(i,null),!i.defaultPrevented}},Object.defineProperty(_.prototype,"constructor",{value:_,configurable:!0,writable:!0}),"undefined"!=typeof window&&void 0!==window.EventTarget&&Object.setPrototypeOf(_.prototype,window.EventTarget.prototype),e.defineEventAttribute=g,e.EventTarget=_,e.default=_,t.exports=_,t.exports.EventTarget=t.exports.default=_,t.exports.defineEventAttribute=g},953:function(t){t.exports=function(t){return"string"==typeof t&&e.test(t)&&!isNaN(Date.parse(t))};var e=new RegExp("^\\d{4}-\\d{2}-\\d{2}((T\\d{2}:\\d{2}(:\\d{2})?)(\\.\\d{1,6})?(Z|(\\+|-)\\d{2}:\\d{2})?)?$")},7257:function(t,e,n){var r=n(8424);Object.defineProperty(e,"v4",{enumerable:!0,get:function(){return a.default}});var i=r(n(4144)),o=r(n(2501)),a=r(n(651)),s=r(n(5370)),u=r(n(4923)),c=r(n(9484)),l=r(n(4721)),f=r(n(7376)),p=r(n(4216))},4357:function(t,e){function n(t){return 14+(t+64>>>9<<4)+1}function r(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function i(t,e,n,i,o,a){return r((s=r(r(e,t),r(i,a)))<<(u=o)|s>>>32-u,n);var s,u}function o(t,e,n,r,o,a,s){return i(e&n|~e&r,t,e,o,a,s)}function a(t,e,n,r,o,a,s){return i(e&r|n&~r,t,e,o,a,s)}function s(t,e,n,r,o,a,s){return i(e^n^r,t,e,o,a,s)}function u(t,e,n,r,o,a,s){return i(n^(e|~r),t,e,o,a,s)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var i=0;i<e.length;++i)t[i]=e.charCodeAt(i)}return function(t){for(var e=[],n=32*t.length,r="0123456789abcdef",i=0;i<n;i+=8){var o=t[i>>5]>>>i%32&255,a=parseInt(r.charAt(o>>>4&15)+r.charAt(15&o),16);e.push(a)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[n(e)-1]=e;for(var i=1732584193,c=-271733879,l=-1732584194,f=271733878,p=0;p<t.length;p+=16){var d=i,h=c,v=l,y=f;i=o(i,c,l,f,t[p],7,-680876936),f=o(f,i,c,l,t[p+1],12,-389564586),l=o(l,f,i,c,t[p+2],17,606105819),c=o(c,l,f,i,t[p+3],22,-1044525330),i=o(i,c,l,f,t[p+4],7,-176418897),f=o(f,i,c,l,t[p+5],12,1200080426),l=o(l,f,i,c,t[p+6],17,-1473231341),c=o(c,l,f,i,t[p+7],22,-45705983),i=o(i,c,l,f,t[p+8],7,1770035416),f=o(f,i,c,l,t[p+9],12,-1958414417),l=o(l,f,i,c,t[p+10],17,-42063),c=o(c,l,f,i,t[p+11],22,-1990404162),i=o(i,c,l,f,t[p+12],7,1804603682),f=o(f,i,c,l,t[p+13],12,-40341101),l=o(l,f,i,c,t[p+14],17,-1502002290),i=a(i,c=o(c,l,f,i,t[p+15],22,1236535329),l,f,t[p+1],5,-165796510),f=a(f,i,c,l,t[p+6],9,-1069501632),l=a(l,f,i,c,t[p+11],14,643717713),c=a(c,l,f,i,t[p],20,-373897302),i=a(i,c,l,f,t[p+5],5,-701558691),f=a(f,i,c,l,t[p+10],9,38016083),l=a(l,f,i,c,t[p+15],14,-660478335),c=a(c,l,f,i,t[p+4],20,-405537848),i=a(i,c,l,f,t[p+9],5,568446438),f=a(f,i,c,l,t[p+14],9,-1019803690),l=a(l,f,i,c,t[p+3],14,-187363961),c=a(c,l,f,i,t[p+8],20,1163531501),i=a(i,c,l,f,t[p+13],5,-1444681467),f=a(f,i,c,l,t[p+2],9,-51403784),l=a(l,f,i,c,t[p+7],14,1735328473),i=s(i,c=a(c,l,f,i,t[p+12],20,-1926607734),l,f,t[p+5],4,-378558),f=s(f,i,c,l,t[p+8],11,-2022574463),l=s(l,f,i,c,t[p+11],16,1839030562),c=s(c,l,f,i,t[p+14],23,-35309556),i=s(i,c,l,f,t[p+1],4,-1530992060),f=s(f,i,c,l,t[p+4],11,1272893353),l=s(l,f,i,c,t[p+7],16,-155497632),c=s(c,l,f,i,t[p+10],23,-1094730640),i=s(i,c,l,f,t[p+13],4,681279174),f=s(f,i,c,l,t[p],11,-358537222),l=s(l,f,i,c,t[p+3],16,-722521979),c=s(c,l,f,i,t[p+6],23,76029189),i=s(i,c,l,f,t[p+9],4,-640364487),f=s(f,i,c,l,t[p+12],11,-421815835),l=s(l,f,i,c,t[p+15],16,530742520),i=u(i,c=s(c,l,f,i,t[p+2],23,-995338651),l,f,t[p],6,-198630844),f=u(f,i,c,l,t[p+7],10,1126891415),l=u(l,f,i,c,t[p+14],15,-1416354905),c=u(c,l,f,i,t[p+5],21,-57434055),i=u(i,c,l,f,t[p+12],6,1700485571),f=u(f,i,c,l,t[p+3],10,-1894986606),l=u(l,f,i,c,t[p+10],15,-1051523),c=u(c,l,f,i,t[p+1],21,-2054922799),i=u(i,c,l,f,t[p+8],6,1873313359),f=u(f,i,c,l,t[p+15],10,-30611744),l=u(l,f,i,c,t[p+6],15,-1560198380),c=u(c,l,f,i,t[p+13],21,1309151649),i=u(i,c,l,f,t[p+4],6,-145523070),f=u(f,i,c,l,t[p+11],10,-1120210379),l=u(l,f,i,c,t[p+2],15,718787259),c=u(c,l,f,i,t[p+9],21,-343485551),i=r(i,d),c=r(c,h),l=r(l,v),f=r(f,y)}return[i,c,l,f]}(function(t){if(0===t.length)return[];for(var e=8*t.length,r=new Uint32Array(n(e)),i=0;i<e;i+=8)r[i>>5]|=(255&t[i/8])<<i%32;return r}(t),8*t.length))};e.default=c},4923:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default="00000000-0000-0000-0000-000000000000"},4216:function(t,e,n){var r=n(8424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(4721));var o=function(t){if(!(0,i.default)(t))throw TypeError("Invalid UUID");var e,n=new Uint8Array(16);return n[0]=(e=parseInt(t.slice(0,8),16))>>>24,n[1]=e>>>16&255,n[2]=e>>>8&255,n[3]=255&e,n[4]=(e=parseInt(t.slice(9,13),16))>>>8,n[5]=255&e,n[6]=(e=parseInt(t.slice(14,18),16))>>>8,n[7]=255&e,n[8]=(e=parseInt(t.slice(19,23),16))>>>8,n[9]=255&e,n[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,n[11]=e/4294967296&255,n[12]=e>>>24&255,n[13]=e>>>16&255,n[14]=e>>>8&255,n[15]=255&e,n};e.default=o},1729:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},8794:function(t,e){var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){if(!n&&!(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(r)};var r=new Uint8Array(16)},6637:function(t,e){function n(t,e,n,r){switch(t){case 0:return e&n^~e&r;case 1:case 3:return e^n^r;case 2:return e&n^e&r^n&r}}function r(t,e){return t<<e|t>>>32-e}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=function(t){var e=[1518500249,1859775393,2400959708,3395469782],i=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var o=unescape(encodeURIComponent(t));t=[];for(var a=0;a<o.length;++a)t.push(o.charCodeAt(a))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var s=t.length/4+2,u=Math.ceil(s/16),c=new Array(u),l=0;l<u;++l){for(var f=new Uint32Array(16),p=0;p<16;++p)f[p]=t[64*l+4*p]<<24|t[64*l+4*p+1]<<16|t[64*l+4*p+2]<<8|t[64*l+4*p+3];c[l]=f}c[u-1][14]=8*(t.length-1)/Math.pow(2,32),c[u-1][14]=Math.floor(c[u-1][14]),c[u-1][15]=8*(t.length-1)&4294967295;for(var d=0;d<u;++d){for(var h=new Uint32Array(80),v=0;v<16;++v)h[v]=c[d][v];for(var y=16;y<80;++y)h[y]=r(h[y-3]^h[y-8]^h[y-14]^h[y-16],1);for(var b=i[0],g=i[1],m=i[2],_=i[3],w=i[4],S=0;S<80;++S){var P=Math.floor(S/20),O=r(b,5)+n(P,g,m,_)+w+e[P]+h[S]>>>0;w=_,_=m,m=r(g,30)>>>0,g=b,b=O}i[0]=i[0]+b>>>0,i[1]=i[1]+g>>>0,i[2]=i[2]+m>>>0,i[3]=i[3]+_>>>0,i[4]=i[4]+w>>>0}return[i[0]>>24&255,i[0]>>16&255,i[0]>>8&255,255&i[0],i[1]>>24&255,i[1]>>16&255,i[1]>>8&255,255&i[1],i[2]>>24&255,i[2]>>16&255,i[2]>>8&255,255&i[2],i[3]>>24&255,i[3]>>16&255,i[3]>>8&255,255&i[3],i[4]>>24&255,i[4]>>16&255,i[4]>>8&255,255&i[4]]};e.default=i},7376:function(t,e,n){var r=n(8424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;for(var i=r(n(4721)),o=[],a=0;a<256;++a)o.push((a+256).toString(16).substr(1));var s=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(o[t[e+0]]+o[t[e+1]]+o[t[e+2]]+o[t[e+3]]+"-"+o[t[e+4]]+o[t[e+5]]+"-"+o[t[e+6]]+o[t[e+7]]+"-"+o[t[e+8]]+o[t[e+9]]+"-"+o[t[e+10]]+o[t[e+11]]+o[t[e+12]]+o[t[e+13]]+o[t[e+14]]+o[t[e+15]]).toLowerCase();if(!(0,i.default)(n))throw TypeError("Stringified UUID is invalid");return n};e.default=s},4144:function(t,e,n){var r=n(8424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,o,a=r(n(8794)),s=r(n(7376)),u=0,c=0;var l=function(t,e,n){var r=e&&n||0,l=e||new Array(16),f=(t=t||{}).node||i,p=void 0!==t.clockseq?t.clockseq:o;if(null==f||null==p){var d=t.random||(t.rng||a.default)();null==f&&(f=i=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==p&&(p=o=16383&(d[6]<<8|d[7]))}var h=void 0!==t.msecs?t.msecs:Date.now(),v=void 0!==t.nsecs?t.nsecs:c+1,y=h-u+(v-c)/1e4;if(y<0&&void 0===t.clockseq&&(p=p+1&16383),(y<0||h>u)&&void 0===t.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=h,c=v,o=p;var b=(1e4*(268435455&(h+=122192928e5))+v)%4294967296;l[r++]=b>>>24&255,l[r++]=b>>>16&255,l[r++]=b>>>8&255,l[r++]=255&b;var g=h/4294967296*1e4&268435455;l[r++]=g>>>8&255,l[r++]=255&g,l[r++]=g>>>24&15|16,l[r++]=g>>>16&255,l[r++]=p>>>8|128,l[r++]=255&p;for(var m=0;m<6;++m)l[r+m]=f[m];return e||(0,s.default)(l)};e.default=l},2501:function(t,e,n){var r=n(8424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(5855)),o=r(n(4357)),a=(0,i.default)("v3",48,o.default);e.default=a},5855:function(t,e,n){var r=n(8424);Object.defineProperty(e,"__esModule",{value:!0}),e.URL=e.DNS=void 0,e.default=function(t,e,n){function r(t,r,a,s){if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=[],n=0;n<t.length;++n)e.push(t.charCodeAt(n));return e}(t)),"string"==typeof r&&(r=(0,o.default)(r)),16!==r.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var u=new Uint8Array(16+t.length);if(u.set(r),u.set(t,r.length),(u=n(u))[6]=15&u[6]|e,u[8]=63&u[8]|128,a){s=s||0;for(var c=0;c<16;++c)a[s+c]=u[c];return a}return(0,i.default)(u)}try{r.name=t}catch(t){}return r.DNS=a,r.URL=s,r};var i=r(n(7376)),o=r(n(4216));var a="6ba7b810-9dad-11d1-80b4-00c04fd430c8";e.DNS=a;var s="6ba7b811-9dad-11d1-80b4-00c04fd430c8";e.URL=s},651:function(t,e,n){var r=n(8424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(8794)),o=r(n(7376));var a=function(t,e,n){var r=(t=t||{}).random||(t.rng||i.default)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,e){n=n||0;for(var a=0;a<16;++a)e[n+a]=r[a];return e}return(0,o.default)(r)};e.default=a},5370:function(t,e,n){var r=n(8424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(5855)),o=r(n(6637)),a=(0,i.default)("v5",80,o.default);e.default=a},4721:function(t,e,n){var r=n(8424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(1729));var o=function(t){return"string"==typeof t&&i.default.test(t)};e.default=o},9484:function(t,e,n){var r=n(8424);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=r(n(4721));var o=function(t){if(!(0,i.default)(t))throw TypeError("Invalid UUID");return parseInt(t.substr(14,1),16)};e.default=o},7362:function(t,e,n){n.d(e,{a:function(){return i}});var r="https://aswpapius.com",i="0.0.0",o={VERSION:"1.22.2",appVersion:i,configured:!1,workerUrl:"/push-worker.js",apiUrl:r,storagePrefix:"_ua_sdk",deprecatedStoragePrefix:null,disableAnalytics:!1,appKey:null,secret:null,token:null,defaultIcon:"",defaultTitle:"",defaultActionURL:"",vapidPublicKey:null,debug:!1,websitePushId:null,registrationDomain:null,mixedRegistrationDomains:!1,secureHost:"",secureBridgePath:null,secureBridgeUrl:null,dataCollectionOptInEnabled:!1,secureIframeUrl:null,skipWaiting:!0,allowedDomains:null,loadIfPushNotSupported:!1,trackEventsForOptOutChannels:!1,safariServiceUrl:r+"/api/safari/web-service/",paths:{cla:"/api/channels",cra:"/api/web-channels",tags:"/api/web-channels/tags",attributes:"/api/channels/attributes",custom_events:"/api/web-events/custom",remote_data:{app:"/api/remote-data/app"},subscription_lists:{list:"/api/subscription_lists/channels",update:"/api/channels/subscription_lists"},named_user:{associate:"/api/named_users/associate",disassociate:"/api/named_users/disassociate",tags:"/api/named_users/tags"},contact:{identify:"/api/contacts/identify",resolve:"/api/contacts/resolve",reset:"/api/contacts/reset",batch:"/api/contacts",subscription_lists_list:"/api/subscription_lists/contacts",registration:{email:"/api/channels/restricted/email",sms:"/api/channels/restricted/sms",open:"/api/channels/restricted/open"}},reports:{direct:"/api/web-events/direct",session:"/api/web-events/session",customEvent:"/api/web-events/custom",featureFlagInteraction:"/api/web-events/ff_interaction"}},consts:{DISABLE_ANALYTICS:"disable_analytics"},contacts:{sessionLengthMs:36e5,namedUserTtlMs:2592e6,_forceExpireNamedUsers:!1},subscriptionLists:{cacheTtlMs:3e5},remoteData:{cacheTtlMs:6e5}};e.Z=o},5731:function(t,e,n){n.d(e,{Aj:function(){return s},Gx:function(){return u},ZF:function(){return c},uy:function(){return a}});var r=n(7834),i=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},o=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function a(t){return"preference_forms"===t.type}function s(t){return"feature_flags"===t.type}function u(t){return"in_app_messages"===t.type}var c=Object(),l=function(){function t(t,e){this._config=t,this._request=e}return t.prototype.get=function(t){var e=t.locale,n=t.ifModifiedSince;return i(this,void 0,void 0,(function(){var t,i,a,s,u,l,f,p,d;return o(this,(function(o){switch(o.label){case 0:t=this._config,i=t.paths,a=t.sdkVersion,s=t.appKey,u=i.app+"/"+s+"/web/",l={sdk_version:a},(null==e?void 0:e.language)&&(null==e?void 0:e.country)&&(l.language=e.language,l.country=e.country),f={},n&&(f["If-Modified-Since"]=new Date(n).toUTCString()),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this._request.get(u,{queryParams:l,headers:f,cache:"reload"})];case 2:return p=o.sent(),[3,4];case 3:if((d=o.sent())instanceof r.L&&304===d.statusCode)return[2,c];throw d;case 4:if(!p.ok)throw new Error("unexpected response");return[2,p.payloads]}}))}))},t}();e.ZP=l},2124:function(t,e,n){n.d(e,{TP:function(){return p},f6:function(){return l},q0:function(){return f}});var r=n(2029),i=n(9726),o=n(5731),a=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},s=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},u=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},c=function(){function t(t,e,n){this._client=t,this._locale=e,this._cache=n}return t.prototype.get=function(){return a(this,void 0,void 0,(function(){var t,e=this;return s(this,(function(n){switch(n.label){case 0:return[4,this._locale()];case 1:return t=n.sent(),[2,this._cache.get(this._cacheKey(t),(function(n){return a(e,void 0,void 0,(function(){var e;return s(this,(function(r){switch(r.label){case 0:return[4,this._client.get({locale:t,ifModifiedSince:n})];case 1:return(e=r.sent())===o.ZF?[2,i.b2]:[2,e]}}))}))}))]}}))}))},t.prototype._cacheKey=function(t){var e,n;return"remote_data:"+[null!==(e=t.language)&&void 0!==e?e:"default",null!==(n=t.country)&&void 0!==n?n:"default"].join("-")},t}();e.ZP=c;var l=function(){function t(t){this._remote=t}return t.prototype.get=function(t){return a(this,void 0,void 0,(function(){var e,n,r,i,o,a;return s(this,(function(s){switch(s.label){case 0:return[4,this.list()];case 1:e=s.sent();try{for(n=u(e),r=n.next();!r.done;r=n.next())if((i=r.value).id===t)return[2,i]}catch(t){o={error:t}}finally{try{r&&!r.done&&(a=n.return)&&a.call(n)}finally{if(o)throw o.error}}return[2,null]}}))}))},t.prototype.list=function(){return a(this,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return[4,this._remote.get()];case 1:return t=n.sent(),e=[],t.filter(o.uy).forEach((function(t){t.data.preference_forms.forEach((function(t){return e.push(t.form)}))})),[2,e]}}))}))},t}(),f=Object.freeze({exists:!1,eligible:!1,data:null,_meta:void 0}),p=function(){function t(t,e,n){this._remote=t,this._provider=e,this._reporter=n}return t.prototype.get=function(t){return a(this,void 0,void 0,(function(){var e,r;return s(this,(function(i){switch(i.label){case 0:return[4,this._list()];case 1:return e=i.sent(),r=e.filter((function(e){return e.object.name===t})),r.length?[4,n.e(548).then(n.bind(n,8548))]:[2,f];case 2:return[2,(0,i.sent().default)(r,this._provider)]}}))}))},t.prototype._list=function(){return a(this,void 0,void 0,(function(){var t,e;return s(this,(function(n){switch(n.label){case 0:return[4,this._remote.get()];case 1:return t=n.sent(),e=[],t.filter(o.Aj).forEach((function(t){t.data.feature_flags.forEach((function(t){var n=t.flag,r=t.created,i=t.last_updated;e.push({object:n,meta:{created:r,lastModified:i}})}))})),[2,e]}}))}))},t.prototype.trackInteraction=function(t){return a(this,void 0,void 0,(function(){var e;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this._reporter.featureFlagInteraction(t,new Date)];case 1:return n.sent(),[3,3];case 2:if(!((e=n.sent())instanceof r.DA))throw e;return console.debug("unable to track feature flag interaction: "+e.message),[3,3];case 3:return[2]}}))}))},t}();!function(){function t(t){this._remote=t}t.prototype.list=function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this._remote.get()];case 1:return[2,t.sent().filter(o.Gx).reduce((function(t,e){return t.concat(e.data.in_app_messages)}),[])]}}))}))}}()},2029:function(t,e,n){n.d(e,{$P:function(){return s},DA:function(){return o},oo:function(){return a}});var r,i=(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=function(t){function e(n){void 0===n&&(n="reporting error");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return i(e,t),e}(Error),a=function(t){function e(n){void 0===n&&(n="should not report");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return i(e,t),e}(o),s=function(t){function e(n){void 0===n&&(n="invalid reporting event");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return i(e,t),e}(o)},4382:function(t,e,n){function r(t){return Array.isArray(t)?t:[t]}function i(t){return void 0===t||Array.isArray(t)?t:[t]}n.d(e,{Z:function(){return r},i:function(){return i}})},9726:function(t,e,n){n.d(e,{Gk:function(){return c},ZL:function(){return f},b2:function(){return u},fU:function(){return l}});var r=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},i=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},o=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},a=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},s=Object(),u=Object(),c=function(){function t(t,e){var n=t.ttlMs,r=t.prefix,i=t._getNow;this._ttlMs=n,this._prefix=r,this._getNow=null!=i?i:function(){return Date.now()},this._storage=e}return t.prototype._getExpiry=function(t){var e;return void 0!==t.expires?t.expires:(null!==(e=t.cachedAt)&&void 0!==e?e:0)+this._ttlMs},t.prototype._getCachedAt=function(t){var e;return void 0!==t.cachedAt?t.cachedAt:Math.max(0,(null!==(e=t.expires)&&void 0!==e?e:0)-this._ttlMs)},t.prototype._getValue=function(t){var e,n=this._storage.getItem(t);if(!n)return s;try{e=JSON.parse(n)}catch(e){return this._storage.removeItem(t),s}return e},t.prototype._getExpired=function(t){return this._getNow()>this._getExpiry(t)},t.prototype.info=function(t){var e=this._makeKey(t),n=this._getValue(e);return n===s?{cachedAt:0,exists:!1,expired:!0}:{cachedAt:this._getCachedAt(n),exists:!0,expired:this._getExpired(n)}},t.prototype.load=function(t,e){var n=this._makeKey(t),r=this._getValue(n);return r===s?s:this._getExpired(r)?(this._storage.removeItem(n),e?r.data:s):r.data},t.prototype.store=function(t,e){var n={cachedAt:this._getNow(),data:e};this._storage.setItem(this._makeKey(t),JSON.stringify(n))},t.prototype.invalidate=function(t){this._storage.removeItem(this._makeKey(t))},t.prototype._makeKey=function(t){return this._prefix+":"+t},t}(),l=function(){function t(t){this._storageManager=t}return t.prototype.get=function(t,e){return r(this,void 0,void 0,(function(){var n,r,o;return i(this,(function(i){switch(i.label){case 0:return n=this._storageManager.info(t),(r=this._storageManager.load(t,!0))===s||n.expired?[4,e(n.exists?n.cachedAt:void 0)]:[2,r];case 1:if((o=i.sent())===u){if(!n.exists||r===s)throw new Error("unable to cache a missed value");return this._storageManager.store(t,r),[2,r]}return this._storageManager.store(t,o),[2,o]}}))}))},t.prototype.invalidate=function(t){this._storageManager.invalidate(t)},t}(),f=function(){function t(t,e){var n=t.keyFn,r=t.indexKey;this._storageManager=e,this._indexKey=r,this._keyFn=n}return t.prototype.values=function(){var t=this,e=[],n=this._storageManager.load(this._indexKey);return n===s?[]:(n.forEach((function(r){var i=t._storageManager.load(r);i===s?t._storageManager.store(t._indexKey,n.filter((function(t){return t!==r}))):e.push(i)})),e)},t.prototype.push=function(t){var e=this._keyFn(t);this._pushToIndex(e),this._storageManager.store(e,t)},t.prototype._pushToIndex=function(t){var e=this._storageManager.load(this._indexKey);if(e!==s){var n=e.filter((function(e){return e!==t}));this._storageManager.store(this._indexKey,a(a([],o(n)),[t]))}else this._storageManager.store(this._indexKey,[t])},t}()},8730:function(t,e,n){n.d(e,{Z:function(){return a}});var r=n(7362),i=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},o=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};function a(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(r.Z.debug){if(1===t.length&&(Array.isArray(t[0])||"object"==typeof t[0])&&console.table)return console.table(t[0]);console.log.apply(console,o([],i(t)))}}},7834:function(t,e,n){n.d(e,{L:function(){return a},f:function(){return o}});var r,i=(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),o=function(t){function e(n){void 0===n&&(n="Predicate was not satisfied.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return i(e,t),e}(TypeError),a=function(t){function e(n,r){void 0===r&&(r="Request Error");var i=t.call(this,r)||this;return i._statusCode=n,Object.setPrototypeOf(i,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(i,e),i.name=i.constructor.name,i}return i(e,t),Object.defineProperty(e.prototype,"statusCode",{get:function(){return this._statusCode},enumerable:!1,configurable:!0}),e}(Error)}},r={};function i(t){var e=r[t];if(void 0!==e)return e.exports;var o=r[t]={id:t,loaded:!1,exports:{}};return n[t](o,o.exports,i),o.loaded=!0,o.exports}i.m=n,i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.f={},i.e=function(t){return Promise.all(Object.keys(i.f).reduce((function(e,n){return i.f[n](t,e),e}),[]))},i.u=function(t){return"ua-"+t+".min.js"},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t={},e="web-push-sdk:",i.l=function(n,r,o,a){if(t[n])t[n].push(r);else{var s,u;if(void 0!==o)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var f=c[l];if(f.getAttribute("src")==n||f.getAttribute("data-webpack")==e+o){s=f;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",e+o),s.src=n),t[n]=[r];var p=function(e,r){s.onerror=s.onload=null,clearTimeout(d);var i=t[n];if(delete t[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(t){return t(r)})),e)return e(r)},d=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),u&&document.head.appendChild(s)}},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},function(){var t;i.g.importScripts&&(t=i.g.location+"");var e=i.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&!t;)t=n[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=t}(),function(){var t={630:0};i.f.j=function(e,n){var r=i.o(t,e)?t[e]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise((function(n,i){r=t[e]=[n,i]}));n.push(r[2]=o);var a=i.p+i.u(e),s=new Error;i.l(a,(function(n){if(i.o(t,e)&&(0!==(r=t[e])&&(t[e]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,r[1](s)}}),"chunk-"+e,e)}};var e=function(e,n){var r,o,a=n[0],s=n[1],u=n[2],c=0;if(a.some((function(e){return 0!==t[e]}))){for(r in s)i.o(s,r)&&(i.m[r]=s[r]);if(u)u(i)}for(e&&e(n);c<a.length;c++)o=a[c],i.o(t,o)&&t[o]&&t[o][0](),t[o]=0},n=self.webpackChunkweb_push_sdk=self.webpackChunkweb_push_sdk||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}(),function(){var t,e=i(1656),n=i(5397),r=i(7362),o=i(8730),a=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},s=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};try{t=window}catch(e){t=self}function u(e,n,r,i,u){var c;function l(){return c||(c=new Promise((function(i,a){var s=t.indexedDB.open(e(),u);s.addEventListener("upgradeneeded",(function(t){var e=t.target.result;try{e.createObjectStore(n,r)}catch(t){(0,o.Z)('Error when "upgrading" indexedDB',t)}})),s.addEventListener("success",(function(){return i(s.result)})),s.addEventListener("error",(function(t){return a(t)}))})),c)}function f(t,e){void 0===e&&(e=!1);var r=e?"readwrite":"readonly";return t.transaction([n],r).objectStore(n)}function p(t,e,n){return void 0===e&&(e=function(t){return t.target.result}),void 0===n&&(n=function(t){return t.target.error}),new Promise((function(r,i){t.addEventListener("success",(function(t){r(e(t))})),t.addEventListener("error",(function(t){return i(n(t))}))}))}function d(){return l().then((function(t){return p(f(t).getAll())}))}return{getDB:l,getObjectStore:f,requestToPromise:p,get:function(t){return l().then((function(e){return p(f(e).get(t),(function(t){if(void 0!==t.target.result)return i(t)}))}))},getAll:d,set:function(t,e){return l().then((function(n){return r.keyPath?p(f(n,!0).put({type:t,value:e})):p(f(n,!0).put(e,t))}))},count:function(){return(0,o.Z)("Db.count(): counting db %s",e()),l().then((function(t){return p(f(t).count())}))},remove:function(t){return l().then((function(e){return p(f(e,!0).delete(t))}))},copy:function(t){return a(this,void 0,void 0,(function(){var e,n;return s(this,(function(r){switch(r.label){case 0:return[4,t.count()];case 1:return r.sent()?[2,!1]:[4,d()];case 2:return(null==(e=r.sent())?void 0:e.length)?((0,o.Z)("Db.copy(): coppying db"),n=e.map((function(e){return t.set(e.type,e.value)})),[4,Promise.all(n)]):[3,4];case 3:return r.sent(),[2,!0];case 4:return[2,!1]}}))}))}}}var c=u((function(){return r.Z.storagePrefix+":db"}),"blob",{keyPath:"type"},(function(t){var e;return null===(e=t.target.result)||void 0===e?void 0:e.value}),1),l=function(){return l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},l.apply(this,arguments)},f=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},p=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},d=function(){function t(t){this._country=null,this._language=null,this._channel=null,(null==t?void 0:t.country)&&this.setCountry(null==t?void 0:t.country),(null==t?void 0:t.language)&&this.setLanguage(null==t?void 0:t.language)}return Object.defineProperty(t.prototype,"country",{get:function(){return this._country},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"language",{get:function(){return this._language},enumerable:!1,configurable:!0}),t.getStoredLocale=function(){return f(this,void 0,void 0,(function(){var t;return p(this,(function(e){switch(e.label){case 0:return[4,c.get("localeOverride")];case 1:return[2,{country:(null==(t=e.sent())?void 0:t.locale_country)||null,language:(null==t?void 0:t.locale_language)||null}]}}))}))},t.fromStorage=function(){return f(this,void 0,void 0,(function(){return p(this,(function(e){switch(e.label){case 0:return[4,t.getStoredLocale()];case 1:return[2,new t(e.sent())]}}))}))},t.prototype.setCountry=function(t){return"string"==typeof t&&2!==t.trim().length?Promise.reject("setCountry(): country should be two characters long"):(this._country="string"==typeof t?t.trim().toUpperCase():null,this._store())},t.prototype.setLanguage=function(t){return"string"==typeof t&&2!==t.trim().length?Promise.reject("setLanguage(): language should be two characters long"):(this._language="string"==typeof t?t.trim().toLowerCase():null,this._store())},t.prototype.set=function(t){var e=[];return void 0!==t.country&&e.push(this.setCountry(t.country)),void 0!==t.language&&e.push(this.setLanguage(t.language)),Promise.all(e).then((function(){}))},t.prototype.setChannel=function(t){this._channel=t,this._channel._setLocaleOverride(this)},t.prototype.clear=function(){var t=this;return this._language=null,this._country=null,c.remove("localeOverride").then((function(){var e;return null===(e=t._channel)||void 0===e?void 0:e._store(!1)})).then((function(){}))},t.prototype.toJSON=function(){return l(l({},this.country?{locale_country:this.country}:{}),this.language?{locale_language:this.language}:{})},t.prototype._store=function(){var t,e;return f(this,void 0,void 0,(function(){return p(this,(function(n){switch(n.label){case 0:return[4,c.set("localeOverride",this.toJSON())];case 1:return n.sent(),[4,null===(t=this._channel)||void 0===t?void 0:t._store(!1)];case 2:return n.sent(),[4,null===(e=this._channel)||void 0===e?void 0:e.update()];case 3:return n.sent(),[2]}}))}))},t}(),h=i(4314),v=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};function y(t){var e=Intl.DateTimeFormat().resolvedOptions(),n=e.timeZone,r=v(e.locale.split("-"),2),i=r[0],o=r[1],a=(null==t?void 0:t.language)||i,s=(null==t?void 0:t.country)||o;!s&&navigator.languages&&(s=navigator.languages.reduce((function(t,e){return t||(t=e.includes("-")?e.split("-")[1]:null),t}),null)||"");return{localeCountry:s,localeLanguage:a,timezone:n}}var b=function(){return b=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},b.apply(this,arguments)},g=["chrome","edge","firefox","opera","safari","yandex browser"];function m(t){var e=t.optedIn,n=t.localeOverride,i=h.parse(navigator.userAgent),o=i.browser,a=i.platform,s={};try{var u=y(n),c=u.localeCountry,l=u.localeLanguage;s={timezone:u.timezone,locale_country:c,locale_language:l}}catch(t){}var f=navigator.userAgent,p=function(t){if(!t)return"unknown";if(t=t.toLowerCase(),!g.includes(t))return"unknown";return t.split(" ")[0]}(o.name),d=p+"-"+o.version,v="mobile"===a.type||"tablet"===a.type?"mobile":"desktop",m=r.Z.VERSION,_=r.Z.appVersion!==r.a?r.Z.appVersion:void 0;return b(b({},s),{device_type:"web",opt_in:e,app_version:_,web:{user_agent_string:f,browser_name:p,browser_version:d,browser_type:v,web_sdk_version:m}})}var _=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},w=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},S="dataCollectionEnabled";function P(){return _(this,void 0,void 0,(function(){var t,e;return w(this,(function(n){switch(n.label){case 0:return t=r.Z.dataCollectionOptInEnabled,[4,c.get(S)];case 1:return void 0!==(e=n.sent())?[2,e]:[4,c.set(S,!t)];case 2:return n.sent(),[2,!t]}}))}))}function O(t,e){var n,r,i,o,a,s;return _(this,void 0,void 0,(function(){return w(this,(function(u){switch(u.label){case 0:return t?[3,3]:(null===(r=null===(n=e.channel)||void 0===n?void 0:n.tags)||void 0===r||r.clear(),[4,null===(o=null===(i=e.channel)||void 0===i?void 0:i.namedUser)||void 0===o?void 0:o.remove()]);case 1:return u.sent(),[4,null===(a=e.channel)||void 0===a?void 0:a.optOut()];case 2:return u.sent(),[3,6];case 3:return[4,e.getNotificationPermission()];case 4:return"granted"!==u.sent()?[3,6]:[4,null===(s=e.channel)||void 0===s?void 0:s.set({opt_in:!0})];case 5:u.sent(),u.label=6;case 6:return[4,c.set(S,t)];case 7:return u.sent(),[2]}}))}))}var E=i(9726);function x(t,e){t=""+r.Z.apiUrl+t;var n={Accept:"application/vnd.urbanairship+json; version=3;"};if(r.Z.appKey&&r.Z.token)n["X-UA-Appkey"]=r.Z.appKey,n.Authorization="Bearer "+r.Z.token;else if(r.Z.appKey&&r.Z.secret){var i=self.btoa(r.Z.appKey+":"+r.Z.secret);n.Authorization="Basic "+i}return e.credentials="include",e.body&&(n["Content-type"]="application/json","string"!=typeof e.body&&(e.body=JSON.stringify(e.body))),e.headers=e.headers||{},Object.assign(e.headers,n),(0,o.Z)("REQUEST",t,e),self.fetch(t,e)}var M=i(4382),k=i(7834),A=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},T=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return self.fetch.apply(self,T([],A(t)))},I=function(){return I=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},I.apply(this,arguments)},j=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},N=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},R=function(){function t(t){this._config=t}return t.prototype.get=function(t,e){return this._jsonRequestResponse("GET",t,e)},t.prototype.put=function(t,e,n){return this._jsonRequestResponse("PUT",t,n,e)},t.prototype.post=function(t,e,n){return this._jsonRequestResponse("POST",t,n,e)},t.prototype.patch=function(t,e,n){return this._jsonRequestResponse("PATCH",t,n,e)},t.prototype.delete=function(t,e){return j(this,void 0,void 0,(function(){return N(this,(function(n){switch(n.label){case 0:return[4,this._requestResponse("DELETE",t,null!=e?e:{})];case 1:return n.sent(),[2]}}))}))},t.prototype._authHeaders=function(){switch(this._config.type){case"basic":return{Authorization:"Basic "+self.btoa(this._config.appKey+":"+this._config.secret)};case"bearer":return{"X-UA-Appkey":this._config.appKey,Authorization:"Bearer "+this._config.token};default:var t=this._config;throw new Error("invalid config: "+t)}},t.prototype._requestResponse=function(e,n,r){var i=r.headers,o=r.queryParams,a=void 0===o?{}:o,s=r.body,u=r.cache;return j(this,void 0,void 0,(function(){var r,o,c,l,f;return N(this,(function(p){switch(p.label){case 0:return r=new URL(""+this._config.apiBase+n),o={method:e,cache:u},c=I({Accept:t.V3_ACCEPT_HEADER},this._authHeaders()),l=new URLSearchParams(r.search.slice(1)),Object.keys(a).forEach((function(t){(0,M.Z)(a[t]).forEach((function(e){l.append(t,e.toString())}))})),r.search=l.toString(),o.credentials="include",s&&(c["Content-Type"]="application/json",o.body="string"==typeof s?s:JSON.stringify(s)),o.headers=I(I({},c),null!=i?i:{}),[4,C(r.toString(),o)];case 1:if(!(f=p.sent()).ok)throw new k.L(f.status,f.statusText);return[2,f]}}))}))},t.prototype._jsonRequestResponse=function(t,e,n,r){var i=void 0===n?{}:n,o=i.headers,a=i.queryParams,s=i.predicate,u=i.cache;return j(this,void 0,void 0,(function(){var n;return N(this,(function(i){switch(i.label){case 0:return[4,this._requestResponse(t,e,{headers:o,queryParams:a,body:r,cache:u})];case 1:return[4,i.sent().json()];case 2:if(n=i.sent(),s&&!s(n))throw new k.f;return[2,n]}}))}))},t.V3_ACCEPT_HEADER="application/vnd.urbanairship+json; version=3;",t}(),B=R;function Z(t){if(t.appKey&&t.token)return new B({apiBase:t.apiUrl,appKey:t.appKey,type:"bearer",token:t.token});if(t.appKey&&t.secret)return new B({apiBase:t.apiUrl,appKey:t.appKey,type:"basic",secret:t.secret});throw new Error("invalid auth configuration: appKey and at least one of token or secret must be configured.")}var L=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},U=["tags","channel"],D={set:function(t,e){var n;return null===(n=self.localStorage)||void 0===n?void 0:n.setItem(F(t),e)},get:function(t){var e;return null===(e=self.localStorage)||void 0===e?void 0:e.getItem(F(t))},setJSON:function(t,e){return this.set(t,JSON.stringify(e))},getJSON:function(t){var e=this.get(t);if(e)return JSON.parse(e)},clear:function(){var t;null===(t=self.localStorage)||void 0===t||t.clear()},remove:function(t){var e;return null===(e=self.localStorage)||void 0===e?void 0:e.removeItem(F(t))},onStorage:function(t){return function(e){var n,i;try{for(var o=L(U),a=o.next();!a.done;a=o.next()){var s=a.value,u=r.Z.storagePrefix+":"+s;if(e.key===u){var c={};c[s]=JSON.parse(e.newValue||""),t(c)}}}catch(t){n={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}}}};function F(t){return r.Z.storagePrefix+":"+t}function q(t){return(null!=t?t:new Date).toISOString().split(".")[0]}var G,V,K,W=(G=function(t,e){return G=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},G(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}G(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),J=function(t){function e(n){void 0===n&&(n="The provided name is not valid.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return W(e,t),e}(Error);function z(t){if("string"==typeof t)return t;if("number"==typeof t)return t.toString(10);if(t instanceof Date)return q(t);throw new J("invalid attribute value")}!function(t){t.SET="set",t.REMOVE="remove"}(V||(V={})),function(t){t.ADD="add",t.SET="set",t.REMOVE="remove"}(K||(K={}));var H=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Q=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Y=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},$=function(){function t(t){this._getAudience=t}return t.prototype.set=function(t){return H(this,void 0,void 0,(function(){return Q(this,(function(e){switch(e.label){case 0:return[4,P()];case 1:return e.sent()?[2,this.send(this.buildSetPayload(t))]:(console.warn("Data collection is disabled. Setting attributes is not allowed."),[2,!1])}}))}))},t.prototype.remove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.send(this.buildRemovePayload(t))},t.prototype.send=function(t,e){var n=void 0===e?{path:r.Z.paths.attributes,method:"post"}:e,i=n.path,o=n.method;return H(this,void 0,void 0,(function(){var e;return Q(this,(function(n){switch(n.label){case 0:if(t.attributes.length<1)return[2,Promise.resolve(!1)];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,x(i,{method:o,body:t})];case 2:return[2,n.sent().ok||Promise.reject(!1)];case 3:return e=n.sent(),[2,Promise.reject(e)];case 4:return[2]}}))}))},t.prototype.buildSetPayload=function(t){var e=Y((new Date).toISOString().split("."),1)[0],n=Object.entries(t).map((function(t){var n=Y(t,2);return{key:n[0],value:z(n[1]),action:V.SET,timestamp:e}}));return{audience:this._getAudience(),attributes:n}},t.prototype.buildRemovePayload=function(t){var e=Y((new Date).toISOString().split("."),1)[0],n=t.map((function(t){return{key:t,action:V.REMOVE,timestamp:e}}));return{audience:this._getAudience(),attributes:n}},t}(),X=$,tt=i(7690),et=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nt=function(t){function e(n){void 0===n&&(n="Cannot perform this operation without an associated channel.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return et(e,t),e}(Error),rt=function(t){function e(n){void 0===n&&(n="The provided name is not valid.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return et(e,t),e}(Error),it=function(t){function e(n){void 0===n&&(n="Invalid tag group.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return et(e,t),e}(Error),ot=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},at=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},st=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},ut=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};function ct(t){var e=[];return ut([],st(t)).reverse().filter((function(t){return!e.includes(t.key)&&(e.push(t.key),!0)})).map(ft).reverse()}function lt(t){var e={},n={},r={};return t.forEach((function(t){switch(t.action){case"add":return e[t.group]||(e[t.group]=new Set),void t.tags.forEach((function(r){e[t.group].add(r),n[t.group]&&n[t.group].delete(r)}));case"remove":return n[t.group]||(n[t.group]=new Set),void t.tags.forEach((function(r){n[t.group].add(r),e[t.group]&&e[t.group].delete(r)}));case"set":return r[t.group]||(r[t.group]=new Set),delete e[t.group],delete n[t.group],void t.tags.forEach((function(e){return r[t.group].add(e)}));default:throw new Error("invalid tag mutation action: "+t)}})),{add:pt(e),remove:pt(n),set:pt(r)}}function ft(t){switch(t.action){case"set":return{action:V.SET,key:t.key,value:z(t.value),timestamp:t.timestamp};case"remove":return{action:V.REMOVE,key:t.key,timestamp:t.timestamp};default:throw new Error("invalid attribute mutation action: "+t)}}function pt(t){var e={};return Object.keys(t).forEach((function(n){var r=ut([],st(t[n].values()));r.length&&(e[n]=r)})),Object.keys(e).length?e:void 0}var dt=function(){function t(t){this._attributeEditor=t}return t.prototype.set=function(t){return ot(this,void 0,void 0,(function(){var e;return at(this,(function(n){switch(n.label){case 0:return[4,this._attributeEditor()];case 1:e=n.sent(),Object.entries(t).forEach((function(t){var n=st(t,2),r=n[0],i=n[1];return e.set(r,i)})),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,e.apply()];case 3:return n.sent(),[2,!0];case 4:return n.sent(),[2,!1];case 5:return[2]}}))}))},t.prototype.remove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ot(this,void 0,void 0,(function(){var e;return at(this,(function(n){switch(n.label){case 0:return[4,this._attributeEditor()];case 1:e=n.sent(),t.forEach((function(t){return e.remove(t)})),n.label=2;case 2:return n.trys.push([2,4,,5]),[4,e.apply()];case 3:return n.sent(),[2,!0];case 4:return n.sent(),[2,!1];case 5:return[2]}}))}))},t}();var ht=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),vt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},yt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},bt=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},gt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},mt=function(t){function e(e){var n=t.call(this)||this;return n.storeName=e,n._tagList={},n.tagMap=new Map,n._load(),n}return ht(e,t),e.prototype.has=function(t,e){void 0===e&&(e="device"),console.warn("Tags.has() is deprecated, and will be removed in a future version.");var n=this.tagMap.get(e);return!!n&&n.has(t)},e.prototype.add=function(t,e){var n;return void 0===e&&(e=""),vt(this,void 0,void 0,(function(){return yt(this,(function(r){switch(r.label){case 0:return[4,P()];case 1:return r.sent()?(e=this._validateGroup(e),this.has(t,e)?[2,!0]:(this.tagMap.has(e)?null===(n=this.tagMap.get(e))||void 0===n||n.add(t):this.tagMap.set(e,new Set([t])),[2,this._send(K.ADD,[t],e)])):(console.warn("Data collection is disabled. Adding tags is not allowed."),[2,!1])}}))}))},e.prototype.remove=function(t,e){var n;return void 0===e&&(e=""),vt(this,void 0,void 0,(function(){return yt(this,(function(r){return e=this._validateGroup(e),this.has(t,e)?(null===(n=this.tagMap.get(e))||void 0===n||n.delete(t),[2,this._send(K.REMOVE,[t],e)]):[2,!0]}))}))},e.prototype.clear=function(){this.tagMap=new Map,this.set([],"device")},e.prototype.set=function(t,e){return void 0===e&&(e=""),vt(this,void 0,void 0,(function(){return yt(this,(function(n){switch(n.label){case 0:return[4,P()];case 1:return!n.sent()&&t.length?(console.warn("Data collection is disabled. Setting tags is not allowed."),[2,!1]):(e=this._validateGroup(e),this.tagMap.set(e,new Set(t)),[2,this._send(K.SET,t,e)])}}))}))},Object.defineProperty(e.prototype,"list",{get:function(){var t,e;console.warn("Tags.list is deprecated, and will be removed in a future version.");var n={};try{for(var r=bt(this.tagMap),i=r.next();!i.done;i=r.next()){var o=gt(i.value,2),a=o[0],s=o[1];s.size&&(n[a]=Array.from(s))}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},enumerable:!1,configurable:!0}),e.prototype._load=function(t){var e,n;void 0===t&&(t=D.getJSON(this.storeName));var r=new Map;try{if(t)try{for(var i=bt(Object.keys(t)),a=i.next();!a.done;a=i.next()){var s=a.value;r.set(s,new Set(t[s]))}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}catch(t){(0,o.Z)("Error loading tags:",t)}return this.tagMap=r,this.tagMap},e.prototype._send=function(t,e,n){return vt(this,void 0,void 0,(function(){return yt(this,(function(r){return this._store(),[2,this._apply(t,e,n)]}))}))},e.prototype.sync=function(t){this._load(t),this._store()},e.prototype._store=function(){var t=this.list;if(t!==this._tagList){D.setJSON("tags",t),this._tagList=t;var e=new CustomEvent("tags",{detail:t});this.dispatchEvent(e)}},e}(n.EventTarget);function _t(t,e,n){var r=t.storeName,i=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return ht(r,t),r.prototype._apply=function(t,n,r){return e(t,n,r)},r.prototype._validateGroup=function(t){return n(t)},r}(mt);return new i(r)}var wt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},St=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Pt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Ot=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},Et=function(){function t(t){var e=this,n=t.getName,r=t.setName,i=t.getChannelId,o=t.getContact;this._contact=o,this._getName=n,this._setName=r,this._getChannelId=i,this._attributes=new dt((function(){return wt(e,void 0,void 0,(function(){return St(this,(function(t){switch(t.label){case 0:return[4,this._contact()];case 1:return[2,t.sent().editAttributes()]}}))}))})),this._tags=_t({storeName:"namedUserTags"},(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e._applyTags.apply(e,Ot([],Pt(t)))}),(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e._validateTagGroup.apply(e,Ot([],Pt(t)))}))}return Object.defineProperty(t.prototype,"id",{get:function(){return console.warn("accessing the `id` of a named user may return a non-canonical response. its use is deprecated."),this._getName()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"attributes",{get:function(){return this._attributes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"channelId",{get:function(){return this._getChannelId()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tags",{get:function(){return this._tags},enumerable:!1,configurable:!0}),t.prototype.set=function(t){return wt(this,void 0,void 0,(function(){var e,n;return St(this,(function(r){switch(r.label){case 0:return[4,this._contact()];case 1:return[4,(e=r.sent())._namedUserIdEquals(t)];case 2:if(n=r.sent(),!t||n)return[2,!1];r.label=3;case 3:return r.trys.push([3,5,,6]),[4,e.identify(t)];case 4:return r.sent(),this._setName(t),[2,!0];case 5:return r.sent(),[2,!1];case 6:return[2]}}))}))},t.prototype.remove=function(){return wt(this,void 0,void 0,(function(){var t;return St(this,(function(e){switch(e.label){case 0:return this._getName()?[4,this._contact()]:[2,!1];case 1:t=e.sent(),e.label=2;case 2:return e.trys.push([2,4,,5]),[4,t.reset()];case 3:return e.sent(),this._setName(null),[2,!0];case 4:return e.sent(),[2,!1];case 5:return[2]}}))}))},t.prototype._applyTags=function(t,e,n){return wt(this,void 0,void 0,(function(){var r;return St(this,(function(i){switch(i.label){case 0:return[4,this._contact()];case 1:return[4,i.sent().editTags()];case 2:switch(r=i.sent(),t){case K.ADD:r.add(n,e);break;case K.REMOVE:r.remove(n,e);break;case K.SET:r.set(n,e);break;default:throw new Error("invalid tag action: "+t)}i.label=3;case 3:return i.trys.push([3,5,,6]),[4,r.apply()];case 4:return i.sent(),[2,!0];case 5:return i.sent(),[2,!1];case 6:return[2]}}))}))},t.prototype._validateTagGroup=function(t){if(void 0===t&&(t=""),!t.trim())throw Error("group is mandatory.");if("device"===t)throw Error('"device" group is not available for a named user.');return t},t}();Et.prototype.set=tt(Et.prototype.set,1e3);var xt=Et,Mt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),kt=function(t){function e(n){void 0===n&&(n="Data collection is not enabled.");var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return Mt(e,t),e}(Error),At=function(t){function e(n){var r=t.call(this,n)||this;return Object.setPrototypeOf(r,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(r,e),r.name=r.constructor.name,r}return Mt(e,t),e}(Error),Tt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Ct=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},It=function(){function t(t,e,n){this._client=t,this._channel=e,this._datCollectionEnabled=n}return t.prototype.list=function(){return Tt(this,void 0,void 0,(function(){var t;return Ct(this,(function(e){switch(e.label){case 0:return[4,this._channel()];case 1:return t=e.sent(),[2,this._client.listSubscriptions(t)]}}))}))},t.prototype.edit=function(){return Tt(this,void 0,void 0,(function(){var t,e=this;return Ct(this,(function(n){switch(n.label){case 0:return[4,this._channel()];case 1:return t=n.sent(),[2,(r=function(n){return Tt(e,void 0,void 0,(function(){return Ct(this,(function(e){switch(e.label){case 0:return[4,this._datCollectionEnabled()];case 1:if(!e.sent())throw new kt;return[2,this._client.updateSubscriptions(t,n)]}}))}))},i=function(){function t(){this._mutations=[]}return t.prototype.apply=function(){return Tt(this,void 0,void 0,(function(){return Ct(this,(function(t){switch(t.label){case 0:return[4,r(this._mutations)];case 1:return t.sent(),[2]}}))}))},t.prototype.subscribe=function(t){this._mutations.push({action:"subscribe",listId:t,timestamp:q()})},t.prototype.unsubscribe=function(t){this._mutations.push({action:"unsubscribe",listId:t,timestamp:q()})},t}(),new i)]}var r,i}))}))},t}(),jt=It;var Nt=function(){return Nt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Nt.apply(this,arguments)},Rt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Bt=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};function Zt(t){var e=[];return t.reverse().filter((function(t){return!e.includes(t.listId)&&(e.push(t.listId),!0)})).reverse()}function Lt(t){return Zt(t).map(qt)}function Ut(t,e){var n=Zt(e),r=Bt([],Rt(t));return n.forEach((function(t){var e=t.action,n=t.listId;"subscribe"!==e||r.includes(n)||r.push(n),"unsubscribe"===e&&r.includes(n)&&(r=r.filter((function(t){return t!==n})))})),r}function Dt(t){var e=[];return Bt([],Rt(t)).reverse().filter((function(t){return!e.find((function(e){return e.listId===t.listId&&e.scope===t.scope}))&&(e.push(t),!0)})).reverse()}function Ft(t){return Dt(t).map(Gt)}function qt(t){return{action:t.action,list_id:t.listId,timestamp:t.timestamp}}function Gt(t){return{action:t.action,list_id:t.listId,timestamp:t.timestamp,scope:t.scope}}function Vt(t,e){var n=Nt({},t);return Dt(e).forEach((function(t){var e=t.listId,r=t.scope,i=t.action;n[e]||(n[e]=[]),"subscribe"!==i||n[e].includes(r)||n[e].push(r),"unsubscribe"===i&&n[e].includes(r)&&(n[e]=n[e].filter((function(t){return t!==r}))),n[e].length||delete n[e]})),n}var Kt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Wt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Jt(t,e){var n=(void 0===e?{}:e).defaultValue,r=void 0===n||n;if("boolean"==typeof t)return t;if(void 0===t)return r;try{return JSON.parse(t)}catch(t){return r}}var zt=function(){function t(t,e){this._config=t,this._request=e}return t.prototype.listSubscriptions=function(t){return Kt(this,void 0,void 0,(function(){var e,n;return Wt(this,(function(r){switch(r.label){case 0:return e=this._config.paths.list+"/"+t,[4,this._request.get(e)];case 1:if(!(n=r.sent()).ok)throw new Error("unexpected response");return[2,n.list_ids]}}))}))},t.prototype.updateSubscriptions=function(t,e){return Kt(this,void 0,void 0,(function(){var n,r;return Wt(this,(function(i){switch(i.label){case 0:return e.length?(n=this._config.paths.update,r={subscription_lists:Lt(e),audience:{web_channel:t}},[4,this._request.post(n,r)]):[2];case 1:return i.sent(),[2]}}))}))},t}(),Ht=function(){function t(t,e,n){this._client=t,this._cache=e,this._mutationCache=n}return t.prototype.updateSubscriptions=function(t,e){return Kt(this,void 0,void 0,(function(){var n=this;return Wt(this,(function(r){switch(r.label){case 0:return[4,this._client.updateSubscriptions(t,e)];case 1:return r.sent(),e.forEach((function(t){return n._mutationCache.push(t)})),this._cache.invalidate(this._listKey(t)),[2]}}))}))},t.prototype.listSubscriptions=function(t){return Kt(this,void 0,void 0,(function(){var e,n,r=this;return Wt(this,(function(i){switch(i.label){case 0:return[4,this._cache.get(this._listKey(t),(function(){return r._client.listSubscriptions(t)}))];case 1:return e=i.sent(),n=this._mutationCache.values(),[2,Ut(e,n)]}}))}))},t.prototype._listKey=function(t){return t+":subscription_lists"},t.createClient=function(e,n,r,i){return new t(new zt(e,n),r,i)},t}(),Qt=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yt=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},$t=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Xt=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},te=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},ee=function(t){function e(e,n){var r=t.call(this)||this;return r.opt_in=!0,r.namedUserChanges=0,r._contact=e,r.channel_id=n.channel_id,r._named_user_id=null,r._tags=_t({storeName:"tags"},(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r._applyTags.apply(r,te([],Xt(t)))}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r._validateTagGroup.apply(r,te([],Xt(t)))})),r._attributes=new X((function(){return{channel:r.channel_id}})),r._namedUser=new xt({getName:function(){return r._named_user_id},setName:function(t){r.set({named_user_id:t})},getChannelId:function(){return r.channel_id},getContact:function(){return r._contact()}}),r.set(n),r}return Qt(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this.channel_id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"optedIn",{get:function(){return Jt(this.opt_in)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"named_user_id",{get:function(){return console.warn("accessing the `named_user_id` of a channel may return a non-canonical response. its use is deprecated."),this._named_user_id},enumerable:!1,configurable:!0}),e.prototype._createSubscriptionManager=function(){var t=this,e=new E.Gk({prefix:r.Z.storagePrefix,ttlMs:r.Z.subscriptionLists.cacheTtlMs},self.sessionStorage),n=new E.fU(e),i=new E.ZL({indexKey:"channel",keyFn:function(t){return t.listId}},e),o=Ht.createClient({paths:r.Z.paths.subscription_lists},Z(r.Z),n,i);return new jt(o,(function(){return Yt(t,void 0,void 0,(function(){return $t(this,(function(t){return[2,this.channel_id]}))}))}),(function(){return P()}))},Object.defineProperty(e.prototype,"subscriptions",{get:function(){return this._subscriptions||(this._subscriptions=this._createSubscriptionManager()),this._subscriptions},enumerable:!1,configurable:!0}),e.fromStorage=function(t){return Yt(this,void 0,void 0,(function(){var n;return $t(this,(function(r){switch(r.label){case 0:return[4,c.get("channel")];case 1:return(n=r.sent())?[2,new e(t,n)]:[2]}}))}))},e.prototype.optOut=function(){return Yt(this,void 0,void 0,(function(){return $t(this,(function(t){switch(t.label){case 0:return[4,this.set({opt_in:!1})];case 1:return t.sent(),[2,this.update(!1)]}}))}))},Object.defineProperty(e.prototype,"namedUser",{get:function(){return this._namedUser},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return r.Z.paths.cra+"/"+this.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tags",{get:function(){return this._tags},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attributes",{get:function(){return this._attributes},enumerable:!1,configurable:!0}),e.prototype._setLocaleOverride=function(t){this.localeOverride=t},e.prototype.toJSON=function(){return Object.assign(m({optedIn:this.optedIn,localeOverride:this.localeOverride}),{channel_id:this.id,opt_in:this.optedIn})},e.prototype._set=function(t){return console.warn("Channel._set() is deprecated and will be removed in the future. Please use Channel.set() instead."),this.set(t)},e.prototype.set=function(t){var e=Object.keys(t).every((function(t){return"named_user_id"===t}));return e&&this.namedUserChanges++,t.channel_id&&(this.channel_id=t.channel_id),void 0!==t.opt_in?this.opt_in=t.opt_in:this.opt_in=!0,void 0!==t.named_user_id&&(this._named_user_id=t.named_user_id),this._store(e)},e.prototype._store=function(t){return Yt(this,void 0,void 0,(function(){var e,n,r,i;return $t(this,(function(o){switch(o.label){case 0:return[4,P()];case 1:if(!o.sent())return console.warn("Data collection is disabled. Skipping channel storage."),[2,!1];e={channel_id:this.id,opt_in:this.optedIn,named_user_id:this._named_user_id},D.setJSON("channel",e),o.label=2;case 2:return o.trys.push([2,6,,7]),this.localeOverride?[3,4]:(n=this,[4,d.fromStorage()]);case 3:n.localeOverride=o.sent(),o.label=4;case 4:return[4,c.set("channel",e)];case 5:return o.sent(),t&&this.namedUserChanges>10?(console.error("Airship SDK: Maximum named user changes reached"),[2,!1]):(r=new CustomEvent("channel",{detail:this}),this.dispatchEvent(r),[2,!0]);case 6:return i=o.sent(),console.error("Airship SDK: Error while storing channel",i),[2,!1];case 7:return[2]}}))}))},e.prototype._update=function(t){return void 0===t&&(t=!0),console.warn("Channel._update() is deprecated and will be removed in the future. Please use Channel.update() instead."),this.update(t)},e.prototype.update=function(t){return void 0===t&&(t=!0),Yt(this,void 0,void 0,(function(){var e,n;return $t(this,(function(r){switch(r.label){case 0:return e=this.toJSON(),t&&delete e.opt_in,[4,P()];case 1:if(!r.sent())return console.warn("Data collection is disabled. Skipping channel update."),[2,!1];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,x(this.path,{method:"put",body:{channel:e}})];case 3:return r.sent(),[2,!0];case 4:return n=r.sent(),console.error("Airship SDK: Error while updating channel",n),[2,!1];case 5:return[2]}}))}))},e.prototype._applyTags=function(t,e,n){return Yt(this,void 0,void 0,(function(){var i,o,a;return $t(this,(function(s){switch(s.label){case 0:(o={audience:{web_channel:this.channel_id}})[t]=((a={})[n]=e,a),i=o,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,x(r.Z.paths.tags,{method:"post",body:i})];case 2:return[2,s.sent().ok];case 3:return s.sent(),[2,!1];case 4:return[2]}}))}))},e.prototype._validateTagGroup=function(t){return t||"device"},e}(n.EventTarget),ne=ee,re=["web","email","sms","open","ios","android","amazon"];var ie=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},oe=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t};function ae(t,e){return new(function(){function n(){this._mutations=oe([],ie(t))}return n.prototype.apply=function(){return e(this._mutations)},n.prototype.remove=function(t){this._mutations.push({action:"remove",key:t,timestamp:q()})},n.prototype.set=function(t,e){this._mutations.push({action:"set",key:t,value:e,timestamp:q()})},n}())}var se=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ue=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ce=function(){function t(t,e,n){this._client=t,this._cache=e,this._mutationCache=n}return t.prototype.identify=function(t,e,n){return this._client.identify(t,e,n)},t.prototype.resolve=function(t,e){return this._client.resolve(t,e)},t.prototype.reset=function(t,e){return this._client.reset(t,e)},t.prototype.updateAttributes=function(t,e){return this._client.updateAttributes(t,e)},t.prototype.updateTags=function(t,e){return this._client.updateTags(t,e)},t.prototype._subscriptionCacheKey=function(t){return t+":subscription_lists"},t.prototype.listSubscriptions=function(t){return se(this,void 0,void 0,(function(){var e,n,r=this;return ue(this,(function(i){switch(i.label){case 0:return[4,this._cache.get(this._subscriptionCacheKey(t),(function(){return r._client.listSubscriptions(t)}))];case 1:return e=i.sent(),n=this._mutationCache.values(),[2,Vt(e,n)]}}))}))},t.prototype.updateSubscriptions=function(t,e){return se(this,void 0,void 0,(function(){var n=this;return ue(this,(function(r){switch(r.label){case 0:return[4,this._client.updateSubscriptions(t,e)];case 1:return r.sent(),e.forEach((function(t){n._mutationCache.push(t)})),this._cache.invalidate(this._subscriptionCacheKey(t)),[2]}}))}))},t.prototype.associateChannel=function(t,e){return this._client.associateChannel(t,e)},t}(),le=function(){function t(t,e){this._config=t,this._request=e}return t.prototype.identify=function(t,e,n){var r=void 0===n?{}:n,i=r.platform,o=void 0===i?"web":i,a=r.contactId;return se(this,void 0,void 0,(function(){var n,r;return ue(this,(function(i){switch(i.label){case 0:return n=this._config.paths.identify,r={named_user_id:t,channel_id:e,device_type:o},a&&(r.contact_id=a),[4,this._request.post(n,r)];case 1:return[2,i.sent().contact_id]}}))}))},t.prototype.resolve=function(t,e){var n=(void 0===e?{}:e).platform,r=void 0===n?"web":n;return se(this,void 0,void 0,(function(){var e,n,i;return ue(this,(function(o){switch(o.label){case 0:return e=this._config.paths.resolve,n={channel_id:t,device_type:r},[4,this._request.post(e,n)];case 1:return[2,[(i=o.sent()).contact_id,i.is_anonymous]]}}))}))},t.prototype.reset=function(t,e){var n=(void 0===e?{}:e).platform,r=void 0===n?"web":n;return se(this,void 0,void 0,(function(){var e,n;return ue(this,(function(i){switch(i.label){case 0:return e=this._config.paths.reset,n={channel_id:t,device_type:r},[4,this._request.post(e,n)];case 1:return[2,i.sent().contact_id]}}))}))},t.prototype.updateAttributes=function(t,e){return se(this,void 0,void 0,(function(){return ue(this,(function(n){return[2,this._batch(t,{attributes:e})]}))}))},t.prototype.updateTags=function(t,e){return se(this,void 0,void 0,(function(){return ue(this,(function(n){return[2,this._batch(t,{tags:e})]}))}))},t.prototype.listSubscriptions=function(t){return se(this,void 0,void 0,(function(){var e,n;return ue(this,(function(r){switch(r.label){case 0:return e=this._config.paths.subscription_lists_list+"/"+t,[4,this._request.get(e)];case 1:return n=r.sent(),[2,(i=n.subscription_lists,o={},i.forEach((function(t){var e=t.scope;t.list_ids.forEach((function(t){o[t]?o[t].push(e):o[t]=[e]}))})),o)]}var i,o}))}))},t.prototype.updateSubscriptions=function(t,e){return se(this,void 0,void 0,(function(){return ue(this,(function(n){switch(n.label){case 0:return[4,this._batch(t,{subscriptionLists:e})];case 1:return n.sent(),[2]}}))}))},t.prototype._batch=function(t,e){var n=e.attributes,r=void 0===n?[]:n,i=e.tags,o=void 0===i?[]:i,a=e.associate,s=void 0===a?[]:a,u=e.subscriptionLists,c=void 0===u?[]:u;return se(this,void 0,void 0,(function(){var e,n;return ue(this,(function(i){switch(i.label){case 0:return e=this._config.paths.batch+"/"+t,n={},r.length&&(n.attributes=ct(r)),o.length&&(n.tags=lt(o)),c.length&&(n.subscription_lists=Ft(c)),s.length&&(n.associate=s.map((function(t){return{channel_id:t.channelId,device_type:t.platform}}))),[4,this._request.post(e,n)];case 1:return i.sent(),[2]}}))}))},t.prototype.associateChannel=function(t,e){return se(this,void 0,void 0,(function(){return ue(this,(function(n){return[2,this._batch(t,{associate:[e]})]}))}))},t}();var fe=function(){return fe=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},fe.apply(this,arguments)},pe=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},de=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},he=function(){function t(t,e){this._config=t,this._request=e}return t.prototype.registerEmail=function(t,e){return pe(this,void 0,void 0,(function(){var n,r;return de(this,(function(i){return n=fe({type:"email",address:t,transactional_opted_in:be(e.transactionalOptedIn)},ye(e)),function(t){return!t.doubleOptIn}(e)&&(n.commercial_opted_in=be(e.commercialOptedIn)),r={},function(t){return Boolean(t.doubleOptIn)}(e)&&(r.opt_in_mode="double"),e.properties&&(r.properties=e.properties),[2,this._register(this._config.paths.email,n,{registrationOptions:r})]}))}))},t.prototype.registerSms=function(t,e){return pe(this,void 0,void 0,(function(){var n;return de(this,(function(r){switch(r.label){case 0:return n=fe({msisdn:t,sender:e.senderId},ye(e)),[4,this._request.post(this._config.paths.sms,n)];case 1:return[2,r.sent().channel_id]}}))}))},t.prototype.registerOpen=function(t,e){return pe(this,void 0,void 0,(function(){var n;return de(this,(function(r){return n=fe({type:"open",address:t,opt_in:!0,open:{open_platform_name:e.platformName,identifiers:e.identifiers}},ye(e)),[2,this._register(this._config.paths.open,n)]}))}))},t.prototype._register=function(t,e,n){var r=(void 0===n?{}:n).registrationOptions;return pe(this,void 0,void 0,(function(){var n;return de(this,(function(i){switch(i.label){case 0:return n=fe({channel:e},r),[4,this._request.post(t,n)];case 1:return[2,i.sent().channel_id]}}))}))},t}(),ve=he;function ye(t){return{timezone:t.timezone,locale_country:t.localeCountry,locale_language:t.localeLanguage}}function be(t){if(t)return q(t)}var ge=i(7257),me=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},_e=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},we=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Se=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},Pe="contact.id",Oe="contact.name",Ee="contact.named_user_associated",xe="contact.pending_tag_mutations",Me="contact.pending_attribute_mutations",ke="contact.pending_subscription_list_mutations",Ae=function(t){return"contact."+t+".tag_mutations"},Te=function(t){return"contact."+t+".attribute_mutations"},Ce=function(t){return"contact."+t+".subscription_list_mutations"},Ie="session_resolved_timestamp",je=function(t){return"contact."+t+".associated_channels"},Ne=function(){function t(t,e,n){var r=t.prefix,i=t.sessionLengthMs,o=t.namedUserTtlMs,a=t._forceExpireNamedUsers,s=t._getNow;this._db=e,this._session=n,this._prefix=r,this._sessionLengthMs=i,this._namedUserTtlMs=o,this._forceExpireNamedUsers=a,this._getNow=null!=s?s:function(){return Date.now()}}return t.prototype._key=function(t){return this._prefix+":"+t},t.prototype.sessionResolved=function(){var t,e;return me(this,void 0,void 0,(function(){var n,r,i;return _e(this,(function(o){return n=this._key(Ie),(r=null===(t=this._session)||void 0===t?void 0:t.getItem(n))?(i=Number.parseInt(r,10),Number.isNaN(i)?(null===(e=this._session)||void 0===e||e.removeItem(n),[2,!1]):[2,this._getNow()-i<this._sessionLengthMs]):[2,!1]}))}))},t.prototype.setSessionResolved=function(t){var e,n;return me(this,void 0,void 0,(function(){var r;return _e(this,(function(i){return r=this._key(Ie),[2,t?null===(e=this._session)||void 0===e?void 0:e.setItem(r,String(this._getNow())):null===(n=this._session)||void 0===n?void 0:n.removeItem(r)]}))}))},t.prototype.getOrCreateContactId=function(){return me(this,void 0,void 0,(function(){var t;return _e(this,(function(e){switch(e.label){case 0:return[4,this._db.get(Pe)];case 1:return(t=e.sent())?[3,3]:(t=(0,ge.v4)(),[4,this.setContactId(t)]);case 2:e.sent(),e.label=3;case 3:return[2,t]}}))}))},t.prototype.setContactId=function(t){return me(this,void 0,void 0,(function(){return _e(this,(function(e){switch(e.label){case 0:return[4,this._db.set(Pe,t)];case 1:return e.sent(),[2]}}))}))},t.prototype.clearContactId=function(){return me(this,void 0,void 0,(function(){var t;return _e(this,(function(e){switch(e.label){case 0:return t=(0,ge.v4)(),[4,this._db.set(Pe,t)];case 1:return e.sent(),[2,t]}}))}))},t.prototype.getNamedUserId=function(){return me(this,void 0,void 0,(function(){var t,e;return _e(this,(function(n){switch(n.label){case 0:return[4,this.getNamedUserAssociatedTimestamp()];case 1:return!(t=n.sent())&&this._forceExpireNamedUsers||t&&this._getNow()-t>this._namedUserTtlMs?[2]:[4,this._db.get(Oe)];case 2:return(e=n.sent())&&!t&&this.setNamedUserAssociatedTimestamp(),[2,e]}}))}))},t.prototype.setNamedUserId=function(t){return me(this,void 0,void 0,(function(){return _e(this,(function(e){switch(e.label){case 0:return[4,this._db.set(Oe,t)];case 1:return e.sent(),[4,this.setNamedUserAssociatedTimestamp()];case 2:return e.sent(),[2]}}))}))},t.prototype.clearNamedUserId=function(){return me(this,void 0,void 0,(function(){return _e(this,(function(t){switch(t.label){case 0:return[4,this._db.remove(Oe)];case 1:return t.sent(),[4,this.clearNamedUserAssociatedTimestamp()];case 2:return t.sent(),[2]}}))}))},t.prototype.setNamedUserAssociatedTimestamp=function(){return me(this,void 0,void 0,(function(){return _e(this,(function(t){return this._db.set(Ee,String(this._getNow())),[2]}))}))},t.prototype.clearNamedUserAssociatedTimestamp=function(){return me(this,void 0,void 0,(function(){return _e(this,(function(t){return this._db.remove(Ee),[2]}))}))},t.prototype.getNamedUserAssociatedTimestamp=function(){return me(this,void 0,void 0,(function(){var t,e;return _e(this,(function(n){switch(n.label){case 0:return[4,this._db.get(Ee)];case 1:return(t=n.sent())?(e=Number.parseInt(t,10),Number.isNaN(e)?[4,this.clearNamedUserAssociatedTimestamp()]:[3,3]):[2];case 2:return n.sent(),[2];case 3:return[2,e]}}))}))},t.prototype.getPendingTagMutations=function(){return me(this,void 0,void 0,(function(){var t;return _e(this,(function(e){switch(e.label){case 0:return[4,this._db.get(xe)];case 1:return[2,null!=(t=e.sent())?t:[]]}}))}))},t.prototype.setPendingTagMutations=function(t){return me(this,void 0,void 0,(function(){return _e(this,(function(e){switch(e.label){case 0:return[4,this._db.set(xe,t)];case 1:return e.sent(),[2]}}))}))},t.prototype.appendTagMutations=function(t,e){return me(this,void 0,void 0,(function(){var n;return _e(this,(function(r){switch(r.label){case 0:return[4,this.getTagMutations(t)];case 1:return n=r.sent(),[4,this._db.set(Ae(t),n.concat.apply(n,Se([],we(e))))];case 2:return r.sent(),[2]}}))}))},t.prototype.getTagMutations=function(t){return me(this,void 0,void 0,(function(){var e;return _e(this,(function(n){switch(n.label){case 0:return[4,this._db.get(Ae(t))];case 1:return[2,null!=(e=n.sent())?e:[]]}}))}))},t.prototype.getPendingAttributeMutations=function(){return me(this,void 0,void 0,(function(){var t;return _e(this,(function(e){switch(e.label){case 0:return[4,this._db.get(Me)];case 1:return[2,null!=(t=e.sent())?t:[]]}}))}))},t.prototype.setPendingAttributeMutations=function(t){return me(this,void 0,void 0,(function(){return _e(this,(function(e){switch(e.label){case 0:return[4,this._db.set(Me,t)];case 1:return e.sent(),[2]}}))}))},t.prototype.appendAttributeMutations=function(t,e){return me(this,void 0,void 0,(function(){var n;return _e(this,(function(r){switch(r.label){case 0:return[4,this.getAttributeMutations(t)];case 1:return n=r.sent(),[4,this._db.set(Te(t),n.concat.apply(n,Se([],we(e))))];case 2:return r.sent(),[2]}}))}))},t.prototype.getAttributeMutations=function(t){return me(this,void 0,void 0,(function(){var e;return _e(this,(function(n){switch(n.label){case 0:return[4,this._db.get(Te(t))];case 1:return[2,null!=(e=n.sent())?e:[]]}}))}))},t.prototype.getPendingSubscriptionListMutations=function(){return me(this,void 0,void 0,(function(){var t;return _e(this,(function(e){switch(e.label){case 0:return[4,this._db.get(ke)];case 1:return[2,null!=(t=e.sent())?t:[]]}}))}))},t.prototype.setPendingSubscriptionListMutations=function(t){return me(this,void 0,void 0,(function(){return _e(this,(function(e){switch(e.label){case 0:return[4,this._db.set(ke,t)];case 1:return e.sent(),[2]}}))}))},t.prototype.appendSubscriptionListMutations=function(t,e){return me(this,void 0,void 0,(function(){var n;return _e(this,(function(r){switch(r.label){case 0:return[4,this.getSubscriptionListMutations(t)];case 1:return n=r.sent(),[4,this._db.set(Ce(t),n.concat.apply(n,Se([],we(e))))];case 2:return r.sent(),[2]}}))}))},t.prototype.getSubscriptionListMutations=function(t){return me(this,void 0,void 0,(function(){var e;return _e(this,(function(n){switch(n.label){case 0:return[4,this._db.get(Ce(t))];case 1:return[2,null!=(e=n.sent())?e:[]]}}))}))},t.prototype.getAssociatedChannels=function(t){return me(this,void 0,void 0,(function(){var e;return _e(this,(function(n){switch(n.label){case 0:return[4,this._db.get(je(t))];case 1:return[2,null!=(e=n.sent())?e:[]]}}))}))},t.prototype.appendAssociatedChannel=function(t,e){return me(this,void 0,void 0,(function(){var n;return _e(this,(function(r){switch(r.label){case 0:return[4,this.getAssociatedChannels(t)];case 1:return n=r.sent(),[4,this._db.set(je(t),Se(Se([],we(n)),[e]))];case 2:return r.sent(),[2]}}))}))},t.prototype.clearAssociatedChannels=function(t){return me(this,void 0,void 0,(function(){return _e(this,(function(e){switch(e.label){case 0:return[4,this._db.remove(je(t))];case 1:return e.sent(),[2]}}))}))},t}(),Re=Ne,Be=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Ze=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Le=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Ue=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},De=function(){function t(t,e,n,r,i){this._client=t,this._storage=e,this._contact=n,this._dataCollectionEnabled=r,this._isRelevantToAirship=i}return t.prototype.list=function(){return Be(this,void 0,void 0,(function(){var t;return Ze(this,(function(e){switch(e.label){case 0:return[4,this._contact()];case 1:return t=e.sent(),[2,this._client.listSubscriptions(t)]}}))}))},t.prototype.edit=function(){return Be(this,void 0,void 0,(function(){var t,e,n,r=this;return Ze(this,(function(i){switch(i.label){case 0:return[4,this._contact()];case 1:return t=i.sent(),e=function(e){return Be(r,void 0,void 0,(function(){return Ze(this,(function(n){switch(n.label){case 0:return[4,this._dataCollectionEnabled()];case 1:if(!n.sent())throw new kt;return[4,this._isRelevantToAirship()];case 2:return n.sent()?[3,4]:[4,this._storage.setPendingSubscriptionListMutations(e)];case 3:return n.sent(),[2];case 4:return e.length?[4,this._client.updateSubscriptions(t,e)]:[3,8];case 5:return n.sent(),[4,this._storage.setPendingSubscriptionListMutations([])];case 6:return n.sent(),[4,this._storage.appendSubscriptionListMutations(t,e)];case 7:n.sent(),n.label=8;case 8:return[2]}}))}))},n=qe,[4,this._storage.getPendingSubscriptionListMutations()];case 2:return[2,n.apply(void 0,[i.sent(),e])]}}))}))},t}(),Fe=De;function qe(t,e){return new(function(){function n(){this._mutations=Ue([],Le(t))}return n.prototype.apply=function(){return Be(this,void 0,void 0,(function(){return Ze(this,(function(t){switch(t.label){case 0:return[4,e(this._mutations)];case 1:return t.sent(),[2]}}))}))},n.prototype.subscribe=function(t,e){this._mutations.push({action:"subscribe",listId:t,timestamp:q(),scope:e})},n.prototype.unsubscribe=function(t,e){this._mutations.push({action:"unsubscribe",listId:t,timestamp:q(),scope:e})},n}())}var Ge=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},Ve=function(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t},Ke=["device"],We=["ua_"];function Je(t,e){return new(function(){function n(){this._mutations=Ve([],Ge(t))}return n.prototype.apply=function(){return e(this._mutations)},n.prototype.add=function(t,e){ze(t);var n=Array.isArray(e)?e:[e];this._mutations.push({action:"add",tags:n,group:t,timestamp:q()})},n.prototype.remove=function(t,e){ze(t);var n=Array.isArray(e)?e:[e];this._mutations.push({action:"remove",tags:n,group:t,timestamp:q()})},n.prototype.set=function(t,e){ze(t);var n=Array.isArray(e)?e:[e];this._mutations.push({action:"set",tags:n,group:t,timestamp:q()})},n}())}function ze(t){if(Ke.includes(t))throw new it("invalid tag group for contact: "+t);if(We.some((function(e){return t.startsWith(e)})))throw new it("forbidden tag group prefix for contact: "+t)}var He=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qe=function(){return Qe=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Qe.apply(this,arguments)},Ye=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},$e=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Xe=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a},tn=function(t){function n(n,r,i,o,a,s,u,c){var l,f=t.call(this)||this;return f._channel=n,f._locale=r,f._storage=i,f._client=o,f._registration=a,f._flags=s,f._lifecycle=u,f._emitter=c,f._mutex=new e.Z,f._ready=f._init(),null===(l=f._emitter)||void 0===l||l.addEventListener("channel",(function(t){return f._onChannel(t)})),f}return He(n,t),n.prototype.contactId=function(){return Ye(this,void 0,void 0,(function(){var t=this;return $e(this,(function(e){switch(e.label){case 0:return[4,this._ready];case 1:return e.sent(),[2,this._mutex.acquireAsync().then((function(){return t._storage.getOrCreateContactId()})).finally((function(){return t._mutex.release()}))]}}))}))},n.prototype._init=function(){return Ye(this,void 0,void 0,(function(){var t,e,n,r;return $e(this,(function(i){switch(i.label){case 0:return[4,this._channel()];case 1:return t=i.sent(),[4,this._storage.getNamedUserId()];case 2:return e=i.sent(),t?[4,this._migrate(t,e)]:((0,o.Z)("contact: initialized without channel"),[2]);case 3:return i.sent()?((0,o.Z)("contact: successful migration"),[2]):[4,this._resolve(t.id)];case 4:return n=Xe.apply(void 0,[i.sent(),1]),r=n[0],[4,this._applyPendingAttributeMutations(r)];case 5:return i.sent(),[4,this._applyPendingTagMutations(r)];case 6:return i.sent(),[4,this._applyPendingSubscriptionListMutations(r)];case 7:return i.sent(),(0,o.Z)("contact: initialized"),[2]}}))}))},n.prototype.identify=function(t){return Ye(this,void 0,void 0,(function(){var e=this;return $e(this,(function(n){switch(n.label){case 0:return[4,this._ready];case 1:return n.sent(),function(t){if("string"!=typeof t)throw new rt("must be a string");if(!t.trim())throw new rt("must not be blank")}(t),[2,this._mutex.acquireAsync().then((function(){return e._identify(t)})).then((function(n){return e._lifecycle.accept("contact",Date.now(),{contactId:n,type:"identify",id:t})})).finally((function(){return e._mutex.release()}))]}}))}))},n.prototype._identify=function(t){return Ye(this,void 0,void 0,(function(){var e,n,r;return $e(this,(function(i){switch(i.label){case 0:return[4,this._namedUserIdEquals(t)];case 1:return i.sent()?((0,o.Z)("contact: identify, not setting as user is already identified"),[2,this._storage.getOrCreateContactId()]):[4,this._storage.getNamedUserId()];case 2:return i.sent()?((0,o.Z)("contact: identify, this contact already has a named user. Creating new contact."),[4,this._storage.clearContactId()]):[3,5];case 3:return e=i.sent(),[4,this._resetStoredContact(e)];case 4:i.sent(),i.label=5;case 5:return[4,this._nonCanonicalChannelId()];case 6:if(!(n=i.sent()))throw new nt;return[4,this._doIdentify(t,n)];case 7:return r=i.sent(),(0,o.Z)("contact: identified",t,n,r),[2,r]}}))}))},n.prototype._namedUserIdEquals=function(t){return Ye(this,void 0,void 0,(function(){var e;return $e(this,(function(n){switch(n.label){case 0:return e=t,[4,this._storage.getNamedUserId()];case 1:return[2,e===n.sent()]}}))}))},n.prototype.reset=function(){return Ye(this,void 0,void 0,(function(){var t=this;return $e(this,(function(e){switch(e.label){case 0:return[4,this._ready];case 1:return e.sent(),[4,this._mutex.acquireAsync().then((function(){return t._reset()})).then((function(e){return t._lifecycle.accept("contact",Date.now(),{contactId:e,type:"reset"})})).finally((function(){return t._mutex.release()}))];case 2:return e.sent(),[2]}}))}))},n.prototype._reset=function(){return Ye(this,void 0,void 0,(function(){var t;return $e(this,(function(e){switch(e.label){case 0:return[4,this._channel()];case 1:return t=e.sent(),[4,this._doReset(null==t?void 0:t.id)];case 2:return[2,e.sent()]}}))}))},n.prototype.editAttributes=function(){return Ye(this,void 0,void 0,(function(){var t,e,n=this;return $e(this,(function(r){switch(r.label){case 0:return[4,this._ready];case 1:return r.sent(),[4,this._storage.getOrCreateContactId()];case 2:return t=r.sent(),e=ae,[4,this._storage.getPendingAttributeMutations()];case 3:return[2,e.apply(void 0,[r.sent(),function(e){return Ye(n,void 0,void 0,(function(){return $e(this,(function(n){switch(n.label){case 0:return[4,this._flags.isDataCollectionEnabled()];case 1:if(!n.sent())throw new kt;return[4,this._isRelevantToAirship()];case 2:return n.sent()?[3,4]:[4,this._storage.setPendingAttributeMutations(e)];case 3:case 5:return n.sent(),[2];case 4:return[4,this._applyPendingAttributeMutations(t,e)]}}))}))}])]}}))}))},n.prototype._applyPendingAttributeMutations=function(t,e){return Ye(this,void 0,void 0,(function(){var n,r;return $e(this,(function(i){switch(i.label){case 0:return null==e?[3,1]:(r=e,[3,3]);case 1:return[4,this._storage.getPendingAttributeMutations()];case 2:r=i.sent(),i.label=3;case 3:return(n=r).length?[4,this._client.updateAttributes(t,n)]:[3,7];case 4:return i.sent(),[4,this._storage.setPendingAttributeMutations([])];case 5:return i.sent(),[4,this._storage.appendAttributeMutations(t,n)];case 6:i.sent(),this._lifecycle.accept("contact",Date.now(),{contactId:t,type:"attribute_mutation",mutations:n,outcome:ct(n)}),i.label=7;case 7:return[2]}}))}))},n.prototype.editTags=function(){return Ye(this,void 0,void 0,(function(){var t,e,n=this;return $e(this,(function(r){switch(r.label){case 0:return[4,this._ready];case 1:return r.sent(),[4,this._storage.getOrCreateContactId()];case 2:return t=r.sent(),e=Je,[4,this._storage.getPendingTagMutations()];case 3:return[2,e.apply(void 0,[r.sent(),function(e){return Ye(n,void 0,void 0,(function(){return $e(this,(function(n){switch(n.label){case 0:return[4,this._flags.isDataCollectionEnabled()];case 1:if(!n.sent())throw new kt;return[4,this._isRelevantToAirship()];case 2:return n.sent()?[3,4]:[4,this._storage.setPendingTagMutations(e)];case 3:case 5:return n.sent(),[2];case 4:return[4,this._applyPendingTagMutations(t,e)]}}))}))}])]}}))}))},n.prototype._applyPendingTagMutations=function(t,e){return Ye(this,void 0,void 0,(function(){var n,r;return $e(this,(function(i){switch(i.label){case 0:return null==e?[3,1]:(r=e,[3,3]);case 1:return[4,this._storage.getPendingTagMutations()];case 2:r=i.sent(),i.label=3;case 3:return(n=r).length?[4,this._client.updateTags(t,n)]:[3,7];case 4:return i.sent(),[4,this._storage.setPendingTagMutations([])];case 5:return i.sent(),[4,this._storage.appendTagMutations(t,n)];case 6:i.sent(),this._lifecycle.accept("contact",Date.now(),{contactId:t,type:"tag_mutation",mutations:n,outcome:lt(n)}),i.label=7;case 7:return[2]}}))}))},n.prototype._createSubscriptionManager=function(){var t=this;return new Fe(this._client,this._storage,(function(){return Ye(t,void 0,void 0,(function(){return $e(this,(function(t){switch(t.label){case 0:return[4,this._ready];case 1:return t.sent(),[2,this._storage.getOrCreateContactId()]}}))}))}),(function(){return t._flags.isDataCollectionEnabled()}),(function(){return t._isRelevantToAirship()}))},Object.defineProperty(n.prototype,"subscriptions",{get:function(){return this._subscriptions||(this._subscriptions=this._createSubscriptionManager()),this._subscriptions},enumerable:!1,configurable:!0}),n.prototype._applyPendingSubscriptionListMutations=function(t,e){return Ye(this,void 0,void 0,(function(){var n,r;return $e(this,(function(i){switch(i.label){case 0:return null==e?[3,1]:(r=e,[3,3]);case 1:return[4,this._storage.getPendingSubscriptionListMutations()];case 2:r=i.sent(),i.label=3;case 3:return(n=r).length?[4,this._client.updateSubscriptions(t,n)]:[3,7];case 4:return i.sent(),[4,this._storage.setPendingSubscriptionListMutations([])];case 5:return i.sent(),[4,this._storage.appendSubscriptionListMutations(t,n)];case 6:i.sent(),this._lifecycle.accept("contact",Date.now(),{contactId:t,type:"subscription_list_mutation",mutations:n,outcome:Ft(n)}),i.label=7;case 7:return[2]}}))}))},n.prototype._registerAndAssociateChannel=function(t){return Ye(this,void 0,void 0,(function(){var e,n,r;return $e(this,(function(i){switch(i.label){case 0:return[4,this._ready];case 1:return i.sent(),n=y,[4,this._locale()];case 2:return e=n.apply(void 0,[i.sent()]),[4,t(e)];case 3:return r=i.sent(),[2,this._associateChannel(r)]}}))}))},n.prototype._associateChannel=function(t){return Ye(this,void 0,void 0,(function(){var e;return $e(this,(function(n){switch(n.label){case 0:return[4,this._storage.getOrCreateContactId()];case 1:return e=n.sent(),[4,this._client.associateChannel(e,t)];case 2:return n.sent(),[4,this._storage.appendAssociatedChannel(e,t)];case 3:return n.sent(),[4,this._applyPendingAttributeMutations(e)];case 4:return n.sent(),[4,this._applyPendingTagMutations(e)];case 5:return n.sent(),[4,this._applyPendingSubscriptionListMutations(e)];case 6:return n.sent(),[2]}}))}))},n.prototype.registerEmail=function(t,e){return Ye(this,void 0,void 0,(function(){var n=this;return $e(this,(function(r){return[2,this._registerAndAssociateChannel((function(r){return Ye(n,void 0,void 0,(function(){return $e(this,(function(n){switch(n.label){case 0:return[4,this._registration.registerEmail(t,Qe(Qe({},e),r))];case 1:return[2,{channelId:n.sent(),platform:"email"}]}}))}))}))]}))}))},n.prototype.registerSms=function(t,e){return Ye(this,void 0,void 0,(function(){var n=this;return $e(this,(function(r){return[2,this._registerAndAssociateChannel((function(r){return Ye(n,void 0,void 0,(function(){return $e(this,(function(n){switch(n.label){case 0:return[4,this._registration.registerSms(t,Qe(Qe({},e),r))];case 1:return[2,{channelId:n.sent(),platform:"sms"}]}}))}))}))]}))}))},n.prototype.registerOpen=function(t,e){return Ye(this,void 0,void 0,(function(){var n=this;return $e(this,(function(r){return[2,this._registerAndAssociateChannel((function(r){return Ye(n,void 0,void 0,(function(){return $e(this,(function(n){switch(n.label){case 0:return[4,this._registration.registerOpen(t,Qe(Qe({},e),r))];case 1:return[2,{channelId:n.sent(),platform:"open"}]}}))}))}))]}))}))},n.prototype.associateChannel=function(t,e){return Ye(this,void 0,void 0,(function(){return $e(this,(function(n){switch(n.label){case 0:return[4,this._ready];case 1:if(n.sent(),r=t,!re.includes(r))throw new At("invalid platform: "+t);return[2,this._associateChannel({platform:t,channelId:e})]}var r}))}))},n.prototype._migrate=function(t,e){return Ye(this,void 0,void 0,(function(){var n,r;return $e(this,(function(i){switch(i.label){case 0:return(n=null==t?void 0:t.named_user_id)?n===e?((0,o.Z)("contact: old nu matches new nu, no migration needed"),[2,!1]):[4,this._resolve(t.id,!0)]:((0,o.Z)("contact: no old nu, no migration needed"),[2,!1]);case 1:return r=Xe.apply(void 0,[i.sent(),2]),r[1]?((0,o.Z)("contact: migration for existing user resolved to anonymous"),[2,!1]):[4,this._storage.setNamedUserId(n)];case 2:return i.sent(),[2,!0]}}))}))},n.prototype._resolve=function(t,e){return Ye(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return $e(this,(function(c){switch(c.label){case 0:return[4,this._storage.getOrCreateContactId()];case 1:return n=c.sent(),[4,this._storage.getNamedUserId()];case 2:return r=c.sent(),(i=!e)?[4,this._storage.sessionResolved()]:[3,4];case 3:i=c.sent(),c.label=4;case 4:return i?[2,[n,!r]]:[4,this._client.resolve(t)];case 5:return o=Xe.apply(void 0,[c.sent(),2]),a=o[0],s=o[1],[4,this._storage.setSessionResolved(!0)];case 6:return c.sent(),u=!r===s,n===a&&u?(this._lifecycle.accept("contact",Date.now(),{contactId:a,type:"resolve"}),[2,[a,s]]):[4,this._storage.setContactId(a)];case 7:return c.sent(),s?[4,this._storage.clearNamedUserId()]:[3,9];case 8:c.sent(),c.label=9;case 9:return[4,this._maybeEmitConflict(n,r)];case 10:return c.sent(),this._lifecycle.accept("contact",Date.now(),{contactId:a,type:"resolve"}),[2,[a,s]]}}))}))},n.prototype._doIdentify=function(t,e){return Ye(this,void 0,void 0,(function(){var n,r;return $e(this,(function(i){switch(i.label){case 0:return[4,this._storage.getOrCreateContactId()];case 1:return n=i.sent(),[4,this._client.identify(t,e,{contactId:n})];case 2:return r=i.sent(),n===r?[3,4]:[4,this._maybeEmitConflict(n)];case 3:i.sent(),i.label=4;case 4:return[4,this._storage.setContactId(r)];case 5:return i.sent(),[4,this._storage.setNamedUserId(t)];case 6:return i.sent(),[4,this._storage.setSessionResolved(!0)];case 7:return i.sent(),[2,r]}}))}))},n.prototype._doReset=function(t){return Ye(this,void 0,void 0,(function(){var e,n,r,i;return $e(this,(function(o){switch(o.label){case 0:return[4,this._storage.getOrCreateContactId()];case 1:return e=o.sent(),t?[4,this._client.reset(t)]:[3,3];case 2:return n=o.sent(),[3,5];case 3:return[4,this._storage.clearContactId()];case 4:n=o.sent(),o.label=5;case 5:return e===n?[3,8]:(r=this._maybeEmitConflict,i=[e],[4,this._storage.getNamedUserId()]);case 6:return[4,r.apply(this,i.concat([o.sent()]))];case 7:o.sent(),o.label=8;case 8:return[4,this._resetStoredContact(n)];case 9:return o.sent(),[2,n]}}))}))},n.prototype._onChannel=function(t){return Ye(this,void 0,void 0,(function(){var e,n,r,i;return $e(this,(function(o){switch(o.label){case 0:return[4,this._ready];case 1:return o.sent(),(e=t.detail)?[4,this._isRelevantToAirship()]:[2];case 2:return o.sent()?[4,this._resolve(e.id)]:[2];case 3:return n=Xe.apply(void 0,[o.sent(),1]),r=n[0],[4,this._applyPendingAttributeMutations(r)];case 4:return o.sent(),[4,this._applyPendingTagMutations(r)];case 5:return o.sent(),[4,this._applyPendingSubscriptionListMutations(r)];case 6:return o.sent(),i=new CustomEvent("_channel_handled"),this.dispatchEvent(i),[2]}}))}))},n.prototype._maybeEmitConflict=function(t,e){return Ye(this,void 0,void 0,(function(){var n,r,i,o,a,s;return $e(this,(function(u){switch(u.label){case 0:return[4,this._storage.getAttributeMutations(t)];case 1:return n=u.sent(),[4,this._storage.getTagMutations(t)];case 2:return r=u.sent(),[4,this._storage.getAssociatedChannels(t)];case 3:return i=u.sent(),[4,this._storage.getSubscriptionListMutations(t)];case 4:return o=u.sent(),e||n.length||r.length||i.length||o.length?(a={namedUserId:e,attributes:ct(n),tags:lt(r),subscriptions:Lt(o),associatedChannels:i},s=new CustomEvent("conflict",{detail:a}),this.dispatchEvent(s),[2]):[2]}}))}))},Object.defineProperty(n.prototype,"ready",{get:function(){return this._ready},enumerable:!1,configurable:!0}),n.prototype._isRelevantToAirship=function(){return Ye(this,void 0,void 0,(function(){var t,e,n;return $e(this,(function(r){switch(r.label){case 0:return[4,this._channel()];case 1:return t=r.sent(),[4,this._storage.getOrCreateContactId()];case 2:return e=r.sent(),[4,this._storage.getAssociatedChannels(e)];case 3:return n=r.sent(),[2,!!t||!!n.length]}}))}))},n.prototype._nonCanonicalChannelId=function(){var t;return Ye(this,void 0,void 0,(function(){var e,n,r;return $e(this,(function(i){switch(i.label){case 0:return[4,this._channel()];case 1:return(e=i.sent())?[2,e.id]:[4,this._storage.getOrCreateContactId()];case 2:return n=i.sent(),[4,this._storage.getAssociatedChannels(n)];case 3:return r=i.sent(),[2,null===(t=r[0])||void 0===t?void 0:t.channelId]}}))}))},n.prototype._resetStoredContact=function(t){return Ye(this,void 0,void 0,(function(){return $e(this,(function(e){switch(e.label){case 0:return[4,this._storage.setContactId(t)];case 1:return e.sent(),[4,this._storage.clearNamedUserId()];case 2:return e.sent(),[4,this._storage.setPendingAttributeMutations([])];case 3:return e.sent(),[4,this._storage.setPendingTagMutations([])];case 4:return e.sent(),[2]}}))}))},n}(n.EventTarget);function en(t,e,n,r,i,o){var a=new Re({prefix:t.storagePrefix,sessionLengthMs:t.contacts.sessionLengthMs,namedUserTtlMs:t.contacts.namedUserTtlMs,_forceExpireNamedUsers:t.contacts._forceExpireNamedUsers},c,self.sessionStorage),s=function(t,e){var n=new le(t,e),r=new E.Gk({prefix:t.storagePrefix,ttlMs:t.cacheTtlMs},self.sessionStorage),i=new E.fU(r),o=new E.ZL({indexKey:"contact",keyFn:function(t){return t.listId+":"+t.scope}},r);return new ce(n,i,o)}({paths:t.paths.contact,storagePrefix:t.storagePrefix,cacheTtlMs:t.subscriptionLists.cacheTtlMs},Z(t)),u=new ve({paths:t.paths.contact.registration},Z(t));return new tn(e,n,a,s,u,r,i,o)}function nn(){return window.location}var rn=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};var on=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},an=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},sn=i(953),un=function(){function t(t,e,n,r){if(void 0===n&&(n={}),!t)throw new ReferenceError("argument: `name` is required.");var i=this.getChannel();if(!i)throw new ReferenceError("You must have a registered channel to send events.");this._channel=i,this._name=t,this.value=e,this.properties=n,this.transactionId=r,this.interactionId=nn().href,this.interactionType="url"}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){if(t&&(t=Number(t),Number.isNaN(t)||"number"!=typeof t))throw new TypeError("`value` must be a number");this._value=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),t.prototype._prepareProperties=function(){return this.properties},t.prototype._prepareInteractionId=function(){return on(this,void 0,void 0,(function(){var t,e,n;return an(this,(function(r){switch(r.label){case 0:return this.interactionId===nn().href&&this.interactionId.length<=255?[2,!1]:(t=new window.TextEncoder("utf-8").encode(this.interactionId),[4,window.crypto.subtle.digest("SHA-256",t)]);case 1:return e=r.sent(),n=Array.from(new Uint8Array(e)).map((function(t){return("0"+t.toString(16)).slice(-2)})).join(""),this.interactionId=this.interactionId.slice(0,230)+"..."+n.slice(0,20),[2,!0]}}))}))},t.prototype.validate=function(){var t=this._prepareProperties();this._validateProperties(t);!function(t,e,n){var r,i;void 0===n&&(n="CustomEvent");try{for(var o=rn(e),a=o.next();!a.done;a=o.next()){var s=a.value,u=t[s];if(void 0===u)return;if("string"!=typeof u)throw new TypeError(n+"."+s+" must be a string");if("string"==typeof u&&u.length>255)throw new RangeError(n+"."+s+" has a 255 character limit")}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}}(this,["name","transactionId","interactionId","interactionId"])},t.prototype._validateProperties=function(t){if(Array.isArray(t)||"object"!=typeof t)throw new TypeError("CustomEvent: properties must be an object");var e;try{e=JSON.stringify(t)}catch(t){throw new TypeError("CustomEvent: properties must be JSON serializable.")}if(e.length>32768)throw new RangeError("CustomEvent: properties are "+e.length+" when JSON encoded, exceeding the maximum of 32768.")},t.prototype._validateBooleanProperty=function(t){if(this.properties&&this.properties.hasOwnProperty(t)&&"boolean"!=typeof this.properties[t])throw new TypeError("CustomEvent property '"+t+"' must be a Boolean")},t.prototype._validateIsoDateProperty=function(t){if(this.properties&&this.properties.hasOwnProperty(t)&&!sn(this.properties[t]))throw new TypeError("CustomEvent property '"+t+"' must be an ISO_8601 date string")},t.prototype.toJSON=function(){var t=this.getSession(),e={web_channel:this._channel.id},n=(new Date).toISOString().split(".")[0]+"Z",r=null==t?void 0:t.send_id,i=this._prepareProperties();return{occurred:n,user:e,send_id:r,body:{name:this.name,value:this.value,transaction:this.transactionId,interaction_id:this.interactionId,interaction_type:this.interactionType,template_type:this.templateType,session_id:null==t?void 0:t.id,properties:Object.keys(i).length?i:void 0}}},t.prototype.track=function(){return on(this,void 0,void 0,(function(){return an(this,(function(t){switch(t.label){case 0:return[4,this.reportable()];case 1:return t.sent()?[4,this._prepareInteractionId()]:[2,{ok:!1,message:"Channel is not opted in or analytics/data-collection are disabled."}];case 2:return t.sent(),this.validate(),[2,this.sendEvent()]}}))}))},t}(),cn=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ln=function(t){function e(e,n,r){void 0===n&&(n={});var i=t.call(this,"registered_account",e,n,r)||this;return i.templateType="account",i}return cn(e,t),e.prototype._prepareProperties=function(){return this.value&&(this.properties.ltv=!0),t.prototype._prepareProperties.call(this)},e}(un),fn=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),pn=function(t){function e(e,n,r,i){void 0===r&&(r={});var o=t.call(this,e,n,r,i)||this;return o.templateType="media",o}return fn(e,t),e.prototype.validate=function(){this._validateBooleanProperty("feature"),this._validateIsoDateProperty("published_date"),t.prototype.validate.call(this)},e.prototype._prepareProperties=function(){return this.value&&(this.properties.ltv=!0),t.prototype._prepareProperties.call(this)},e}(un),dn=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"browsed_content",e,n,r)||this}return fn(e,t),e}(pn),hn=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"consumed_content",e,n,r)||this}return fn(e,t),e}(pn),vn=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"starred_content",e,n,r)||this}return fn(e,t),e}(pn),yn=function(t){function e(e,n,r,i){void 0===r&&(r={});var o=t.call(this,"shared_content",void 0,r,i)||this;return o.properties.source=e,o.properties.medium=n,o}return fn(e,t),e}(pn),bn=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gn=function(t){function e(e,n,r,i){void 0===r&&(r={});var o=t.call(this,e,n,r,i)||this;return o.templateType="retail",o}return bn(e,t),e.prototype.validate=function(){this._validateBooleanProperty("new_item"),t.prototype.validate.call(this)},e}(un),mn=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"browsed",e,n,r)||this}return bn(e,t),e}(gn),_n=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"added_to_cart",e,n,r)||this}return bn(e,t),e}(gn),wn=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"purchased",e,n,r)||this}return bn(e,t),e.prototype._prepareProperties=function(){return this.value&&(this.properties.ltv=!0),t.prototype._prepareProperties.call(this)},e}(gn),Sn=function(t){function e(e,n,r){return void 0===n&&(n={}),t.call(this,"starred_product",e,n,r)||this}return bn(e,t),e}(gn),Pn=function(t){function e(e,n,r,i){void 0===r&&(r={});var o=t.call(this,"shared_product",void 0,r,i)||this;return o.properties.source=e,o.properties.medium=n,o}return bn(e,t),e}(gn),On=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();var En=36e5;function xn(t,e){if(void 0===t&&(t={}),void 0===e&&(e=!1),r.Z.configured)return r.Z;delete t.paths,delete t.consts,Object.assign(r.Z,t);var n=new URL(r.Z.workerUrl,r.Z.workerUrl.startsWith("/")?self.location.href:void 0);r.Z.deprecatedStoragePrefix=self.btoa(r.Z.storagePrefix+":"+r.Z.appKey+":"+r.Z.workerUrl);var i=n.pathname.replace(/[^/]+$/,"");if(r.Z.storagePrefix=self.btoa(r.Z.storagePrefix+":"+r.Z.appKey+":"+i),r.Z.secureBridgeUrl=function(t){return t.secureIframeUrl||t.secureBridgeUrl?t.secureIframeUrl||t.secureBridgeUrl:t.registrationDomain&&t.secureBridgePath?new URL(t.secureBridgePath,"https://"+t.registrationDomain).href:null}(r.Z),r.Z.registrationDomain?r.Z.secureHost="https://"+r.Z.registrationDomain:r.Z.secureBridgeUrl&&(r.Z.secureHost=new URL(r.Z.secureBridgeUrl).origin),r.Z.debug){var o=e?"secure-bridge":"main";console.log("UA[%s] configured with:",o,r.Z)}return r.Z.contacts.namedUserTtlMs=Math.max(En,r.Z.contacts.namedUserTtlMs),"string"!=typeof r.Z.appVersion&&(console.error("invalid app version "+r.Z.appVersion+" specified; resetting to default"),r.Z.appVersion=r.a),r.Z.configured=!0,r.Z}function Mn(t,e){t="last_"+t;var n=+new Date,r=D.getJSON(t);return{store:function(){return D.setJSON(t,n)},after:!r||n-r>36e5*e}}var kn=i(2029),An=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Tn=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Cn=2e4;function In(t){return void 0===t&&(t=Date.now()),An(this,void 0,void 0,(function(){var e;return Tn(this,(function(n){switch(n.label){case 0:return[4,c.get("last_send_id")];case 1:return(e=n.sent())&&t-e.timestamp<=Cn?[4,c.remove("last_send_id")]:[3,3];case 2:return n.sent(),[2,e.id];case 3:return[2]}}))}))}var jn=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Nn=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Rn(t,e){return jn(this,void 0,void 0,(function(){var n;return Nn(this,(function(r){switch(r.label){case 0:return e?[2,Bn(t,e)]:[4,Zn()];case 1:return(n=r.sent())?[2,Bn(t,n)]:[2,!1]}}))}))}function Bn(t,e){return jn(this,void 0,void 0,(function(){var n;return Nn(this,(function(i){switch(i.label){case 0:return[4,Ln(t.optedIn)];case 1:if(!i.sent())return[2,!1];n={session_id:e.id,send_id:e.send_id,channel:t.toJSON()},D.setJSON("session",e),i.label=2;case 2:return i.trys.push([2,4,,5]),[4,x(r.Z.paths.reports.session,{method:"post",body:n})];case 3:return[2,i.sent().ok];case 4:return i.sent(),[2,!1];case 5:return[2]}}))}))}function Zn(){return jn(this,void 0,void 0,(function(){var t,e,n;return Nn(this,(function(r){switch(r.label){case 0:return t=Mn("activity",.5),e=t.after,(0,t.store)(),[4,In()];case 1:return(n=r.sent())||e?[2,{id:(0,ge.v4)(),send_id:n}]:[2]}}))}))}function Ln(t){return jn(this,void 0,void 0,(function(){return Nn(this,(function(e){switch(e.label){case 0:return r.Z.disableAnalytics?[2,!1]:[4,c.get(r.Z.consts.DISABLE_ANALYTICS)];case 1:return e.sent()?[2,!1]:t||r.Z.trackEventsForOptOutChannels?[2,P()]:[2,!1]}}))}))}var Un=function(){function t(t,e,n){this._config=t,this._request=e,this._shouldReport=n}return t.prototype.featureFlagInteraction=function(e,n){return jn(this,void 0,void 0,(function(){var r;return Nn(this,(function(i){switch(i.label){case 0:return[4,this._shouldReport()];case 1:if(!i.sent())throw new kn.oo;return r=t._transformFeatureFlag(e,n),[4,this._request.post(this._config.featureFlagInteraction,r)];case 2:return i.sent(),[2]}}))}))},t._transformFeatureFlag=function(t,e){if(!t._meta)throw new kn.$P;return{device:{channel_id:t._meta.device.channelId,contact_id:t._meta.device.contactId},eligible:t.eligible,flag_name:t._meta.name,occurred:q(e),reporting_metadata:t._meta.context}},t}();function Dn(t,e){var n=t.data[r.Z.storagePrefix];return"*"!==e&&t.origin!==e||!n?{}:n}function Fn(t){var e;return(e={})[r.Z.storagePrefix]=t,e}var qn=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};function Gn(t){t.tags&&((0,o.Z)("[secure-bridge] Setting channel tags from message data: %o",t.tags),D.setJSON("tags",t.tags)),t.channel&&((0,o.Z)("[secure-bridge] Setting channel data from message data: %o",t.channel),c.set("channel",t.channel)),t.subscriptionDomain&&((0,o.Z)("[secure-bridge] Setting subscriptionDomain from message data: %s",t.subscriptionDomain),c.set("subscriptionDomain",t.subscriptionDomain))}var Vn=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Kn=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Wn=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},Jn=function(){function t(){this.plugins=new Map,this.loaders=new Map}return Object.defineProperty(t.prototype,"list",{get:function(){var t,e,n=[];try{for(var r=Wn(this.plugins.keys()),i=r.next();!i.done;i=r.next()){var o=i.value;n.push(o)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}return n},enumerable:!1,configurable:!0}),t.prototype.load=function(t,e,n){var r=this,i=this.loaders.get(t);if(i)return i;var o=new Promise((function(i){var o={url:e,opts:n,setLoaded:function(t){i(t)}};r.plugins.set(t,o)}));this.loaders.set(t,o);var a=function(t,e,n){void 0===n&&(n=document);var r=n.createElement("script");return r.src=e,r.async=!0,r.setAttribute("rel",t),n.head.appendChild(r),r}(t,e);return a.addEventListener("error",(function(){throw r.loaders.delete(t),new Error("Error while loading plugin at URL: '"+e+"'")})),o},t.prototype._setLoaded=function(t,e,n){var r=this.plugins.get(t);if(!r)throw new Error("Airship Plugin "+t+" does not match any currently loading plugins: "+this.list.join(", "));return r.setLoaded(e(r.opts,n))},t.prototype.get=function(t){return Vn(this,void 0,void 0,(function(){var e;return Kn(this,(function(n){if(e=this.loaders.get(t))return[2,e];throw new Error("The plugin '"+t+"' is not loaded. Make sure you have called plugins.load(...) correctly.")}))}))},t}(),zn=Jn;function Hn(t){return void 0===t&&(t=self),!("PushManager"in t)&&!!("safari"in t||navigator.userAgent.match(/Safari/)&&!navigator.userAgent.match(/Chrome/))}function Qn(t,e){return e.push_address=t.endpoint,e.web.subscription=t.toJSON().keys,{channel:e}}var Yn=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},$n=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Xn(t){return Yn(this,void 0,void 0,(function(){var e,n,i;return $n(this,(function(o){switch(o.label){case 0:return"string"!=typeof(e=r.Z.vapidPublicKey)?[2,Promise.reject("vapidPublicKey not configured")]:(n=function(t){var e;try{e=window}catch(t){e=self}for(var n=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),r=e.atob(n),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}(e),[4,t.pushManager.getSubscription()]);case 1:return(i=o.sent())?(a=new Uint8Array(i.options.applicationServerKey),s=n,a.length===s.length&&a.every((function(t,e){return t===s[e]}))?[2,i]:[4,i.unsubscribe()]):[3,3];case 2:o.sent(),o.label=3;case 3:return[2,tr(t,n)]}var a,s}))}))}function tr(t,e){return t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e})}function er(t,e){if((Hn()||function(t){return void 0===t&&(t=self),!(!("safari"in t)||!r.Z.websitePushId)&&"granted"===t.safari.pushNotification.permission(r.Z.websitePushId).permission}())&&e)return(n=r.Z.websitePushId,"string"!=typeof n?Promise.reject("No websitePushId configured."):new Promise((function(t,e){window.safari.pushNotification.requestPermission(new window.URL(r.Z.appKey+"/",r.Z.safariServiceUrl).href,n,{},(function(n){if("granted"===n.permission)return t(n);e("Registration failed: permission denied.\nYou may want to check that '"+nn().host+"' is one of your allowed domains.")}))}))).then((function(t){return d.fromStorage().then((function(n){var r,i,o=m({optedIn:e,localeOverride:n});return r=t,(i=o).push_address="granted"===r.permission?r.deviceToken:void 0,i.web.subscription={subscription_type:"apns"},{channel:i}}))}));if(Hn())return d.fromStorage().then((function(t){return{channel:m({optedIn:!1,localeOverride:t})}}));var n,i;return t&&e?(i=t,Notification.requestPermission().then((function(t){if("granted"===t)return i;throw new Error("Notification permission is denied.")}))).then(Xn).then((function(t){return d.fromStorage().then((function(e){var n=m({optedIn:!0,localeOverride:e});return Qn(t,n)}))})):t?d.fromStorage().then((function(t){return{channel:m({optedIn:!1,localeOverride:t})}})):Promise.reject("Worker registration failed")}var nr=i(2124),rr=i(5731);function ir(){return!("standalone"in navigator)||!("ontouchstart"in window)||navigator.standalone}function or(){var t=window.location.hostname;return!r.Z.registrationDomain||t===r.Z.registrationDomain}function ar(){var t=window.isSecureContext;return void 0!==t?t:Boolean(nn().protocol.match("https"))}var sr=["indexedDB","localStorage","fetch","crypto"];function ur(){var t=sr.every((function(t){return t in window}));return r.Z.loadIfPushNotSupported?t:t&&cr()}function cr(){var t=navigator.userAgent.match(/Chrome\/(\d\d)\./);return!(t&&Number(t[1])<52)&&Boolean("PushManager"in window||Hn()&&r.Z.websitePushId&&"safari"in window&&"pushNotification"in window.safari)}var lr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},fr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function pr(){return lr(this,void 0,void 0,(function(){var t;return fr(this,(function(e){switch(e.label){case 0:return r.Z.deprecatedStoragePrefix?[4,c.count()]:[2,!1];case 1:return e.sent()?[2,!1]:(t=u((function(){return r.Z.deprecatedStoragePrefix+":db"}),"blob",{keyPath:"type"},(function(t){var e;return null===(e=t.target.result)||void 0===e?void 0:e.value}),1),[4,t.copy(c)]);case 2:return e.sent(),[2,!0]}}))}))}var dr=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))};var hr=["activating","activated"];function vr(t){return new Promise((function(e,n){t.active&&e(t);var r=t.installing||t.waiting;r?r.addEventListener("statechange",(function(){hr.includes(r.state)&&e(t)})):n("Service worker in an unknown state")}))}var yr="install_date";function br(){var t;return null!==(t=D.getJSON(yr))&&void 0!==t?t:0}var gr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),mr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return gr(e,t),e.prototype.accept=function(t,e,n){var r=new CustomEvent(t,{detail:{timestamp:e,payload:n}});this.dispatchEvent(r)},e}(n.EventTarget),_r=mr;var wr=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Sr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Pr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Or=function(t){function n(){var n,i,a,s,u=t.call(this)||this;u.dataCollectionEnabledSync=!0,u._registrationMutex=new e.Z,u._isSetup=new dr,u._channelPromise=new Promise((function(t){u.addEventListener("channel",(function(e){return t(e.detail)}),{once:!0})})),u._workerRegistration=!Hn()&&navigator.serviceWorker?navigator.serviceWorker.register(r.Z.workerUrl).then(vr):Promise.reject("Worker registration not available in this context"),u._workerRegistration.catch((function(t){return(0,o.Z)("SW Registration Error",t)})),u._channelPromise.then(u.heartbeat.bind(u)),u._channelPromise.then(u.checkPermission.bind(u)),u.isSupported=ur(),u.isWebPushSupported=cr(),u.canRegister=Boolean(cr()&&ar()&&or()&&ir()&&"denied"!==Notification.permission),u.isRegistrationDomain=or(),u.gestureRequired=(i=h.parse(navigator.userAgent).browser,a=(null===(n=i.name)||void 0===n?void 0:n.toLowerCase())||"",s=(null==i?void 0:i.version)?parseFloat(i.version):0,a.includes("safari")&&s>=12.1||a.includes("firefox")&&s>=72),u.isAllowedPushRegistrationContext=ir(),u.setDataCollectionEnabled=function(t){return O(t,u)},u.isDataCollectionEnabled=P,u._lifecycleEvents=new _r,u._eventReporter=new Un(r.Z.paths.reports,Z(r.Z),(function(){var t,e;return Ln(null!==(e=null===(t=u.channel)||void 0===t?void 0:t.optedIn)&&void 0!==e&&e)})),r.Z.secureBridgeUrl&&r.Z.secureBridgeUrl.match(/accengage\.net/)&&!r.Z.mixedRegistrationDomains&&console.warn("WARNING: you should set 'mixedRegistrationDomains' to true if you are migrating from Accengage and were using an Accengage-owned domain"),(0,o.Z)("[main] Web SDK environment:");var l={isSecure:ar(),isRegistrationDomain:u.isRegistrationDomain,mixedRegistrationDomains:r.Z.mixedRegistrationDomains,secureBridgeUrl:r.Z.secureBridgeUrl,allowedDomains:r.Z.allowedDomains};r.Z.secureBridgeUrl&&(l.sbOriginDifferentFromCurrent=new URL(r.Z.secureBridgeUrl).origin!==window.location.origin),(0,o.Z)(l);var f,p=(!ar()||!u.isRegistrationDomain||r.Z.mixedRegistrationDomains)&&r.Z.secureBridgeUrl&&new URL(r.Z.secureBridgeUrl).origin!==window.location.origin&&!Hn();if(p&&!r.Z.secureBridgeUrl&&console.warn("Airship SDK is integrated on a non-secured domain but 'secureIframeUrl' is not provided."),u.hasExistingSubscription=Promise.resolve(),p&&r.Z.secureBridgeUrl){if(function(t,e){(0,o.Z)("Setting up secure-bridge with %s",e);var n=r.Z.secureHost,i=document.createElement("iframe"),a=new Promise((function(t){i.onload=function(){return t(i)}})),s=new URL(e);function u(t){a.then((function(e){var r;(0,o.Z)("[main] Sending data to secure-bridge (%s): %o",n,t),null===(r=e.contentWindow)||void 0===r||r.postMessage(Fn(t),n)}))}s.searchParams.append("__ua_secondary_origin",nn().origin),i.style.display="none",i.src=s.toString(),document.body.appendChild(i),window.addEventListener("message",(function(e){var r=Dn(e,n);t._set(r)})),t.addEventListener("tags",(function(t){u({tags:t.tags})})),t.addEventListener("channel",(function(){c.get("channel").then((function(t){u({channel:t})}))})),t.addEventListener("subscriptiondomain",(function(t){u({subscriptionDomain:t.detail})}))}(u,r.Z.secureBridgeUrl),r.Z.mixedRegistrationDomains){var v=new Promise((function(t){u.addEventListener("subscriptiondomain",(function(e){return t(e.detail)}),{once:!0})}));u.hasExistingSubscription=Promise.race([v,(f=1e3,new Promise((function(t){setTimeout(t,f)})))])}}else u._channelPromise.then((function(t){return Rn(t)}));return u.channel=null,u.localeOverride=new d,u.CustomEvent=function(t,e,n,r){var i,o;return i=function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return On(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(un),i.templates={retail:{AddedToCartEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return On(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(_n),BrowsedEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return On(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(mn),PurchasedEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return On(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(wn),SharedProductEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return On(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(Pn),StarredProductEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return On(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(Sn)},media:{BrowsedContentEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return On(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(dn),ConsumedContentEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return On(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(hn),SharedContentEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return On(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(yn),StarredContentEvent:function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return On(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(vn)},account:(o=function(i){function o(){return null!==i&&i.apply(this,arguments)||this}return On(o,i),o.prototype.getChannel=function(){return t()},o.prototype.getSession=function(){return e()},o.prototype.reportable=function(){return n()},o.prototype.sendEvent=function(){return r(this)},o}(ln),o.RegisterEvent=o,o)},i}((function(){return u.channel}),(function(){return D.getJSON("session")}),(function(){var t,e;return Ln(null!==(e=null===(t=u.channel)||void 0===t?void 0:t.optedIn)&&void 0!==e&&e)}),(function(t){return u.sendCustomEvent(t)})),u.plugins=new zn,u._contactPromise=u.createContact(),window.addEventListener("storage",D.onStorage((function(t){return u._set(t)}))),navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",(function(t){"push"===t.data.type&&((0,o.Z)("Push event from worker",t),u.dispatchEvent({type:"push",push:t.data.push}))})),u}return wr(n,t),n.prototype.sendCustomEvent=function(t){return Sr(this,void 0,void 0,(function(){var e,n;return Pr(this,(function(i){switch(i.label){case 0:return e=t.toJSON(),[4,x(r.Z.paths.custom_events,{method:"post",body:e})];case 1:return 200===(n=i.sent()).status&&this._lifecycleEvents.accept("custom_event",new Date(e.occurred).getTime(),{name:t.name,properties:t.properties,value:t.value}),[2,n.json()]}}))}))},n.prototype.createContact=function(){return Sr(this,void 0,void 0,(function(){var t=this;return Pr(this,(function(e){switch(e.label){case 0:return[4,this._isSetup.promise];case 1:return e.sent(),[2,en(r.Z,(function(){return Sr(t,void 0,void 0,(function(){return Pr(this,(function(t){return[2,this.channel]}))}))}),(function(){return Sr(t,void 0,void 0,(function(){return Pr(this,(function(t){return[2,this.localeOverride]}))}))}),{isDataCollectionEnabled:this.isDataCollectionEnabled},this._lifecycleEvents,this)]}}))}))},n.prototype.checkDataCollection=function(){var t=this;return Promise.resolve(this.dataCollectionEnabled).then((function(e){t.dataCollectionEnabledSync=e}))},n.prototype.checkPermission=function(t){return Sr(this,void 0,void 0,(function(){var e;return Pr(this,(function(n){switch(n.label){case 0:return r.Z.mixedRegistrationDomains?[4,this.hasExistingSubscription]:[3,2];case 1:if(n.sent())return[2];n.label=2;case 2:return[4,this.getNotificationPermission()];case 3:return(e=n.sent())&&"granted"!==e&&t.optedIn&&this.isRegistrationDomain&&t.optOut(),[2]}}))}))},n.prototype.heartbeat=function(t){var e=Mn("heartbeat",24),n=e.after,r=e.store;n&&((0,o.Z)("SENDING heartbeat"),r(),t.optedIn&&this.isRegistrationDomain?this.register().catch((function(){return t.update()})):t.update())},n.prototype.getChannel=function(){return this._channelPromise},n.prototype._legacySetup=function(){try{var t=D.getJSON("channel");(null==t?void 0:t.channel_id)&&this._setChannel(t),this._isSetup.resolve()}catch(t){throw this._isSetup.reject(t),t}},n.prototype._setup=function(){return Sr(this,void 0,void 0,(function(){var t,e=this;return Pr(this,(function(n){switch(n.label){case 0:return[4,pr()];case 1:return n.sent(),(t=[]).push(c.get("channel").then((function(t){t&&t.channel_id&&e._setChannel(t)})).then((function(){return d.getStoredLocale().then((function(t){e.localeOverride.set(t),e.channel&&e.localeOverride.setChannel(e.channel)}))}))),t.push(c.get("subscriptionDomain").then((function(t){t&&e._setSubscriptionDomain(t)}))),t.push(this.checkDataCollection()),[2,Promise.all(t).then((function(){return e._isSetup.resolve()})).catch((function(t){throw e._isSetup.reject(t),t}))]}}))}))},Object.defineProperty(n.prototype,"disableAnalytics",{get:function(){return c.get(r.Z.consts.DISABLE_ANALYTICS).then((function(t){return!!t}))},set:function(t){c.set(r.Z.consts.DISABLE_ANALYTICS,!!t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dataCollectionEnabled",{get:function(){return P()},set:function(t){O(!!t,this),this.dataCollectionEnabledSync=!!t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"permission",{get:function(){var t;if(ar())return null===(t=window.Notification)||void 0===t?void 0:t.permission},enumerable:!1,configurable:!0}),n.prototype.getNotificationPermission=function(){var t,e;return Sr(this,void 0,void 0,(function(){return Pr(this,(function(n){switch(n.label){case 0:return[4,null===(t=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===t?void 0:t.query({name:"notifications"})];case 1:return[2,null===(e=n.sent())||void 0===e?void 0:e.state]}}))}))},Object.defineProperty(n.prototype,"contact",{get:function(){return this._contactPromise},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lifecycleEvents",{get:function(){return this._lifecycleEvents},enumerable:!1,configurable:!0}),n.prototype.register=function(){return Sr(this,void 0,void 0,(function(){var t=this;return Pr(this,(function(e){return[2,this._registrationMutex.acquireAsync().then((function(){return t._register(!0)})).finally((function(){return t._registrationMutex.release()}))]}))}))},n.prototype.create=function(){return Sr(this,void 0,void 0,(function(){var t=this;return Pr(this,(function(e){return[2,this._registrationMutex.acquireAsync().then((function(){var e,n;return t._register(null!==(n=null===(e=t.channel)||void 0===e?void 0:e.optedIn)&&void 0!==n&&n)})).finally((function(){return t._registrationMutex.release()}))]}))}))},n.prototype._register=function(t){return Sr(this,void 0,void 0,(function(){var e,n,i,o,a;return Pr(this,(function(s){switch(s.label){case 0:if(!Hn()){if(!ar())return[2,Promise.reject("Registration not possible on a non-secure context.")];if(!this.isRegistrationDomain)return[2,Promise.reject("Domain is not allowed for registration.")]}if(t&&!this.isAllowedPushRegistrationContext)return[2,Promise.reject("Registration cannot happen in this context.")];if(!this.dataCollectionEnabledSync)return[2,Promise.reject("Data collection is disabled. Cannot register user.")];if(!this.isWebPushSupported)return[2,Promise.reject("Web push not supported in browser")];e=null,s.label=1;case 1:return s.trys.push([1,3,,4]),[4,this._workerRegistration];case 2:return e=s.sent(),[3,4];case 3:return s.sent(),[3,4];case 4:return[4,this.hasExistingSubscription];case 5:return(n=s.sent())&&n!==nn().hostname?[2,Promise.reject("An existing registration exists on "+n)]:[4,er(e,t)];case 6:return i=s.sent(),this.channel?[4,x(this.channel.path,{method:"put",body:i})]:[3,8];case 7:return o=s.sent(),[3,10];case 8:return[4,x(r.Z.paths.cra,{method:"post",body:i})];case 9:o=s.sent(),s.label=10;case 10:return[4,o.json()];case 11:return a=s.sent(),br()||D.setJSON(yr,Date.now()),(0,Mn("heartbeat",24).store)(),this._setSubscriptionDomain(nn().hostname),[2,this._setChannel(a)]}}))}))},Object.defineProperty(n.prototype,"_intlDetails",{get:function(){return y(this.localeOverride)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"_remoteData",{get:function(){var t=this;if(!this._remoteDataProvider){var e=new rr.ZP({paths:r.Z.paths.remote_data,sdkVersion:r.Z.VERSION,appKey:r.Z.appKey},Z(r.Z)),n=new E.Gk({ttlMs:r.Z.remoteData.cacheTtlMs,prefix:r.Z.storagePrefix},self.sessionStorage);this._remoteDataProvider=new nr.ZP(e,(function(){return Sr(t,void 0,void 0,(function(){var t;return Pr(this,(function(e){return[2,{country:(t=this._intlDetails).localeCountry,language:t.localeLanguage}]}))}))}),new E.fU(n))}return this._remoteDataProvider},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"preferenceCenters",{get:function(){return this._preferenceCenterManager||(this._preferenceCenterManager=new nr.f6(this._remoteData)),this._preferenceCenterManager},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"featureFlags",{get:function(){var t=this;if(!this._featureFlagManager){var e={contactId:function(){return Sr(t,void 0,void 0,(function(){return Pr(this,(function(t){switch(t.label){case 0:return[4,this.contact];case 1:return[2,t.sent().contactId()]}}))}))},channelId:function(){return Sr(t,void 0,void 0,(function(){return Pr(this,(function(t){switch(t.label){case 0:return[4,this.getChannel()];case 1:return[2,t.sent().id]}}))}))},channelIdDigest:function(){return Sr(t,void 0,void 0,(function(){var t,e;return Pr(this,(function(n){switch(n.label){case 0:return[4,i.e(137).then(i.bind(i,2137))];case 1:return t=n.sent().sha256Digest,[4,this.getChannel()];case 2:return e=n.sent(),[2,t(e.id)]}}))}))},installTimestamp:function(){return Sr(t,void 0,void 0,(function(){return Pr(this,(function(t){return[2,br()]}))}))},deviceTags:function(){return Sr(t,void 0,void 0,(function(){var t,e;return Pr(this,(function(n){return t=D.getJSON("tags"),[2,null!==(e=null==t?void 0:t.device)&&void 0!==e?e:[]]}))}))},analyticsEnabled:function(){return Sr(t,void 0,void 0,(function(){return Pr(this,(function(t){switch(t.label){case 0:return[4,this.disableAnalytics];case 1:return[2,!t.sent()]}}))}))},locale:function(){return Sr(t,void 0,void 0,(function(){return Pr(this,(function(t){return[2,this.localeOverride]}))}))},location:function(){return Sr(t,void 0,void 0,(function(){var t,e;return Pr(this,(function(n){switch(n.label){case 0:return[4,null===(e=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===e?void 0:e.query({name:"geolocation"})];case 1:return(t=n.sent())?[2,t.state]:[2,"not_determined"]}}))}))},notificationDisplay:function(){return Sr(t,void 0,void 0,(function(){var t,e;return Pr(this,(function(n){switch(n.label){case 0:return[4,null===(e=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===e?void 0:e.query({name:"notifications"})];case 1:return(t=n.sent())?[2,t.state]:[2,"not_determined"]}}))}))},notificationOptIn:function(){return Sr(t,void 0,void 0,(function(){return Pr(this,(function(t){switch(t.label){case 0:return[4,this.getChannel()];case 1:return[2,t.sent().optedIn]}}))}))},appVersion:function(){return Sr(t,void 0,void 0,(function(){return Pr(this,(function(t){return[2,r.Z.appVersion]}))}))}};this._featureFlagManager=new nr.TP(this._remoteData,e,this._eventReporter)}return this._featureFlagManager},enumerable:!1,configurable:!0}),n.prototype._set=function(t){void 0===t&&(t={}),t.channel&&t.channel.channel_id&&this._setChannel(t.channel),t.tags&&this.channel&&this.channel.tags.sync(t.tags),t.subscriptionDomain&&this._setSubscriptionDomain(t.subscriptionDomain),t.session&&this._setSession(t.session)},n.prototype._setSubscriptionDomain=function(t){c.set("subscriptionDomain",t);var e=new CustomEvent("subscriptiondomain",{detail:t});this.dispatchEvent(e)},n.prototype._setChannel=function(t){var e=this;return this.channel?(this.channel.set(t),this.channel):(this.channel=new ne((function(){return e.contact}),t),this.localeOverride.setChannel(this.channel),this.channel.addEventListener("channel",(function(t){t.channel=t.detail,e.dispatchEvent(t)})),this.channel.tags.addEventListener("tags",(function(t){var n=new CustomEvent("tags",{detail:t.detail});n.tags=t.detail,e.dispatchEvent(n)})),this.channel)},n.prototype._setSession=function(t){D.setJSON("session",t),this._channelPromise.then((function(e){Rn(e,t)}))},Object.defineProperty(n.prototype,"isSetup",{get:function(){return this._isSetup.promise},enumerable:!1,configurable:!0}),n}(n.EventTarget),Er=Or,xr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Mr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function kr(t){return xr(this,void 0,void 0,(function(){var e,n,r;return Mr(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,t.registration.pushManager.getSubscription()];case 1:return e=i.sent(),n=e?t.location.hostname:null,[4,c.set("subscriptionDomain",n)];case 2:return i.sent(),[2,!0];case 3:return r=i.sent(),(0,o.Z)("Error while storing subscription domain",r),[2,!1];case 4:return[2]}}))}))}var Ar=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Tr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},Cr=function(){function t(t){var e;this._channelId=t.channelId,this._namedUserId=null!==(e=t.namedUserId)&&void 0!==e?e:null,this._optedIn=t.optedIn,this._localeOverride=t.localeOverride}return Object.defineProperty(t.prototype,"id",{get:function(){return this._channelId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"named_user_id",{get:function(){return console.warn("accessing the `named_user_id` of a channel may return a non-canonical response. its use is deprecated."),this._namedUserId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"optedIn",{get:function(){return this._optedIn},enumerable:!1,configurable:!0}),t.fromStorage=function(e,n){var r;return Ar(this,void 0,void 0,(function(){var i,o;return Tr(this,(function(a){switch(a.label){case 0:return[4,e.get("channel")];case 1:return(i=a.sent())?[4,n()]:[3,3];case 2:return o=a.sent(),[2,new t({channelId:i.channel_id,namedUserId:null!==(r=i.named_user_id)&&void 0!==r?r:void 0,optedIn:Jt(i.opt_in),localeOverride:o})];case 3:return[2]}}))}))},t.prototype.toJSON=function(){return Object.assign(m({optedIn:this.optedIn,localeOverride:this._localeOverride}),{channel_id:this.id,opt_in:this.optedIn})},t}(),Ir=Cr,jr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Nr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Rr(t){return jr(this,void 0,void 0,(function(){return Nr(this,(function(e){try{return[2,Br(t)]}catch(t){n=t,(0,o.Z)("Unable to migrate registration on service worker startup.","Proceeding with installation.",n)}var n;return[2]}))}))}function Br(t,e){return jr(this,void 0,void 0,(function(){var n,r;return Nr(this,(function(i){switch(i.label){case 0:return[4,Xn(t)];case 1:return[4,Zr(i.sent(),e)];case 2:return n=i.sent(),r=Lr,[4,n.json()];case 3:return[2,r.apply(void 0,[i.sent()])]}}))}))}function Zr(t,e){var n=function(t,e){var n=e?{identity_hints:{accengage_device_id:e}}:{},r=Qn(t,m({optedIn:!0}));return Object.assign(r,n)}(t,e);return x(r.Z.paths.cra,{method:"post",body:n})}function Lr(t){var e,n=new Ir({channelId:t.channel_id,namedUserId:null!==(e=t.named_user_id)&&void 0!==e?e:void 0,optedIn:Jt(t.opt_in)});return c.set("channel",n.toJSON())}var Ur,Dr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Fr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function qr(t,e){switch(e.data.command){case Ur.AMP_SUBSCRIPTION_STATE:!function(t){var e,n,r;Dr(this,void 0,void 0,(function(){var i,a,s,u;return Fr(this,(function(l){switch(l.label){case 0:return[4,t.registration.pushManager.getSubscription()];case 1:return i=l.sent(),[4,Ir.fromStorage(c,(function(){return d.fromStorage()}))];case 2:return a=l.sent(),[4,null===(e=null===navigator||void 0===navigator?void 0:navigator.permissions)||void 0===e?void 0:e.query({name:"notifications"})];case 3:return s=null===(n=l.sent())||void 0===n?void 0:n.state,u=null!==i&&(null===(r=null==a?void 0:a.optedIn)||void 0===r||r)&&"granted"===s,(0,o.Z)("AMP[onMessageReceivedSubscriptionState]",{channel:a,isSubscribed:u,permission:s}),Gr(t,Ur.AMP_SUBSCRIPTION_STATE,u),[2]}}))}))}(t);break;case Ur.AMP_SUBSCRIBE:!function(t){(0,o.Z)("AMP[onMessageReceivedSubscribe]"),Rr(t.registration).then((function(){return Gr(t,Ur.AMP_SUBSCRIBE,null)}))}(t);break;case Ur.AMP_UNSUBSCRIBE:!function(t){ne.fromStorage((function(){throw new Error("contact not available in this context")})).then((function(t){return t&&t.optOut()})).then((function(){return Gr(t,Ur.AMP_UNSUBSCRIBE,null)}))}(t)}}function Gr(t,e,n){t.clients.matchAll().then((function(t){for(var r=0;r<t.length;r++){t[r].postMessage({command:e,payload:n})}}))}!function(t){t.AMP_SUBSCRIPTION_STATE="amp-web-push-subscription-state",t.AMP_SUBSCRIBE="amp-web-push-subscribe",t.AMP_UNSUBSCRIBE="amp-web-push-unsubscribe"}(Ur||(Ur={}));var Vr=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Kr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function Wr(){return Vr(this,void 0,void 0,(function(){var t,e;return Kr(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,c.get("channel")];case 1:return[2,null==(t=n.sent())?void 0:t.channel_id];case 2:return e=n.sent(),(0,o.Z)("Error fetching channel ID from indexedDB",e),[3,3];case 3:return[2]}}))}))}var Jr=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},zr=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a};function Hr(t){return Wr().then((function(e){var n={channel_id:e,body:t.body,title:t.title,icon:t.icon,require_interaction:"reqInt"in t&&Boolean(t.reqInt)},r=function(t){var e,n;if(null==t?void 0:t.onClick){var r=new URL(t.onClick.url),i=r.searchParams;try{for(var o=Jr(Object.entries(t.onClick.params||{})),a=o.next();!a.done;a=o.next()){var s=zr(a.value,2),u=s[0],c=s[1];i.set(u,c)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r.search=i.toString(),r.toString()}}(t);return r&&(n.action={"^u":r}),t.a4sb&&Array.isArray(t.a4sb)&&t.a4sb.length&&(n.buttons=t.a4sb.reduce((function(t,e){var n={id:String(e.id),label:e.title,icon:e.icon,actions:{open:{type:"url",content:e.url}}};return t.push(n),t}),[])),"a4sbigpicture"in t&&(n.image=t.a4sbigpicture),n}))}function Qr(t){return"contact"===t.type}function Yr(t){return"channel"===t.type}var $r=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Xr=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},ti=function(){function t(t,e){this._channel=t,this._contact=e}return t.prototype.handleActions=function(t){var e,n;return $r(this,void 0,void 0,(function(){var r,i,o;return Xr(this,(function(a){return r=null===(e=t.subscription_list)||void 0===e?void 0:e.filter(Qr),i=null===(n=t.subscription_list)||void 0===n?void 0:n.filter(Yr),o=[],(null==r?void 0:r.length)&&o.push(this._handleContactSubscriptions(r)),(null==i?void 0:i.length)&&o.push(this._handleChannelSubscriptions(i)),[2,Promise.all(o).then((function(t){return t.every(Boolean)}))]}))}))},t.prototype._handleContactSubscriptions=function(t){return $r(this,void 0,void 0,(function(){var e,n;return Xr(this,(function(r){switch(r.label){case 0:return[4,this._contact()];case 1:return[4,r.sent().subscriptions.edit()];case 2:e=r.sent(),t.forEach((function(t){"subscribe"===t.action?e.subscribe(t.list,t.scope):e.unsubscribe(t.list,t.scope)})),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,e.apply()];case 4:return r.sent(),[2,!0];case 5:return n=r.sent(),console.error(n),[2,!1];case 6:return[2]}}))}))},t.prototype._handleChannelSubscriptions=function(t){return $r(this,void 0,void 0,(function(){var e,n;return Xr(this,(function(r){switch(r.label){case 0:return[4,this._channel()];case 1:return[4,r.sent().subscriptions.edit()];case 2:e=r.sent(),t.forEach((function(t){"subscribe"===t.action?e.subscribe(t.list):e.unsubscribe(t.list)})),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,e.apply()];case 4:return r.sent(),[2,!0];case 5:return n=r.sent(),console.error(n),[2,!1];case 6:return[2]}}))}))},t}(),ei=ti,ni=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ri=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function ii(t,e){var n,i;e.notification.close();var o,a,s,u,l,f=e.action,p=e.notification.data;f?a=null!==(i=null==(o=null===(n=p.buttons)||void 0===n?void 0:n.find((function(t){return t.id===f})))?void 0:o.actions)&&void 0!==i?i:{}:(s=p.action||{},u=s["^u"]||s["^d_a"]||s["^p_a"],(l={}).open=u?{type:"url",content:u}:{type:"home"},s["^+t"]&&(l.add_tag=s["^+t"]),s["^-t"]&&(l.remove_tag=s["^-t"]),s["^sl"]&&(l.subscription_list=s["^sl"]),a=l);var h=p.channel_id,v=p.send_id,y=[],b=function(t){var e,n;return"home"===(null===(e=t.open)||void 0===e?void 0:e.type)?r.Z.defaultActionURL:"url"===(null===(n=t.open)||void 0===n?void 0:n.type)?t.open.content:null}(a);if(b&&t.clients.openWindow&&y.push(t.clients.openWindow(b)),h&&(y.push(function(t,e){void 0===e&&(e={});return ni(this,void 0,void 0,(function(){var n,i,o,a;return ri(this,(function(s){switch(s.label){case 0:if(n=(0,M.i)(e.add_tag),i=(0,M.i)(e.remove_tag),!n&&!i)return[2,!0];o={audience:{channel:t}},n&&(o.add={device:n}),i&&(o.remove={device:i}),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,x(r.Z.paths.tags,{method:"post",body:o})];case 2:return[2,s.sent().ok];case 3:return a=s.sent(),console.error(a),[2,!1];case 4:return[2]}}))}))}(h,a)),y.push(function(t,e){void 0===e&&(e={});return ni(this,void 0,void 0,(function(){function n(){return ni(this,void 0,void 0,(function(){return ri(this,(function(e){return[2,ne.fromStorage((function(){return a})).then((function(e){return null!=e?e:new ne((function(){return a}),{channel_id:t,opt_in:!0})}))]}))}))}function i(){return ni(this,void 0,void 0,(function(){return ri(this,(function(t){return[2,Promise.resolve(en(r.Z,(function(){return o}),(function(){return d.fromStorage()}),{isDataCollectionEnabled:P},new _r))]}))}))}var o,a;return ri(this,(function(t){return e.subscription_list&&e.subscription_list.length?(o=n(),a=i(),[2,new ei((function(){return o}),(function(){return a})).handleActions(e)]):[2,!0]}))}))}(h,a))),v&&h){var g=Ir.fromStorage(c,(function(){return d.fromStorage()})).then((function(t){return t=null!=t?t:new Ir({channelId:h,optedIn:!0}),f?function(t,e,n){return jn(this,void 0,void 0,(function(){var i,o;return Nn(this,(function(a){switch(a.label){case 0:return[4,Ln(t.optedIn)];case 1:return a.sent()?(i=r.Z.paths.reports.customEvent,o={occurred:new Date(Date.now()).toISOString().split(".")[0],user:{web_channel:t.id},send_id:e,body:{name:"button--"+n.toLowerCase(),interaction_type:"ua_interactive_notification"}},[2,x(i,{method:"post",body:o})]):[2,!1]}}))}))}(t,v,f):function(t,e){return jn(this,void 0,void 0,(function(){var n,i;return Nn(this,(function(o){switch(o.label){case 0:return[4,Ln(t.optedIn)];case 1:return o.sent()?(n=r.Z.paths.reports.direct,i={channel:t.toJSON(),send_id:e},[2,x(n,{method:"post",body:i})]):[2,!1]}}))}))}(t,v)}));y.push(g,function(t){return ni(this,void 0,void 0,(function(){var e;return ri(this,(function(n){switch(n.label){case 0:e=Date.now(),n.label=1;case 1:return n.trys.push([1,3,,4]),[4,c.set("last_send_id",{id:t,timestamp:e})];case 2:return n.sent(),[2,!0];case 3:return n.sent(),[2,!1];case 4:return[2]}}))}))}(v))}var m=Promise.all(y);return e.waitUntil(m),m.then((function(){return!0}))}var oi=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ai=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},si=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};function ui(t,e){var n,i=function(t,e){var n;return oi(this,void 0,void 0,(function(){var i,o,a,s,u,c;return ai(this,(function(l){switch(l.label){case 0:return i=function(t){return"a4sid"in t&&"string"==typeof t.a4sid}(e)?Hr(e):Promise.resolve(e),[4,i];case 1:return o=l.sent(),(a=[kr(t)]).push(function(t,e){var n={type:"push",push:e};return t.clients.matchAll().then((function(t){t.forEach((function(t){return t.postMessage(n)}))}))}(t,o)),s=o.title||r.Z.defaultTitle,u=o.require_interaction||!1,c=o.send_id,o.body&&a.push(t.registration.showNotification(s,{body:o.body,icon:o.icon||r.Z.defaultIcon,image:o.image,data:o,actions:null===(n=o.buttons)||void 0===n?void 0:n.map((function(t){return{title:t.label,action:t.id,icon:t.icon}})),requireInteraction:u})),[2,Promise.all(a).catch((function(t){return console.error("error processing notification",t)})).then((function(){return function(t,e){return oi(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return ai(this,(function(c){switch(c.label){case 0:return[4,t.registration.getNotifications()];case 1:if(!(n=c.sent()))return[2];r=Date.now()/1e3;try{for(i=si(n),o=i.next();!o.done;o=i.next())a=o.value,e&&a.data.send_id===e||a.data.expiry&&a.data.expiry<r&&a.close()}catch(t){s={error:t}}finally{try{o&&!o.done&&(u=i.return)&&u.call(i)}finally{if(s)throw s.error}}return[2]}}))}))}(t,c)})).catch((function(t){return console.error("error clearing notifications",t)}))]}}))}))}(t,(null===(n=e.data)||void 0===n?void 0:n.json())||{});return e.waitUntil(i),i}var ci=function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))},li=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};function fi(t,e){var n=Qn(t,m({optedIn:!0}));return x(r.Z.paths.cra+"/"+e,{method:"put",body:n})}try{var pi=document.getElementById("_uasdk"),di=pi.rel,hi=window;pi&&di&&hi[di]?"function"==typeof hi[di]._async_setup?hi[di]._async_setup((function(t){void 0===t&&(t={});if(xn(t),!ur()){var e=new Error("Browser is not supported");if("Promise"in window)return Promise.reject(e);throw e}var n=new Er;return n._setup().then((function(){return n}))})):"function"==typeof hi[di]._setup&&hi[di]._setup((function(t){void 0===t&&(t={});if(xn(t),!ur())throw new Error("Browser is not supported");var e=new Er;return e._legacySetup(),e})):pi&&"secureBridge"===pi.getAttribute("rel")&&(window.uaSetup={secureBridge:function(t){if("https:"!==nn().protocol)throw new Error("The secure bridge must be run on an HTTPS domain that is shared with the push registration page.");xn(t,!0);var e,n,r,i,a=function(t){if(Array.isArray(t)&&t.length){var e=new URL(nn().href).searchParams.get("__ua_secondary_origin");if(!e)throw new Error("Secondary origin not specified. Missing `__ua_secondary_origin` query parameter.");if(!t.includes(e)&&e!==nn().origin)throw new Error("Secondary origin not allowed. Got: "+e+". Allowed: "+JSON.stringify(t));return e}return"http://"+nn().host}(t.allowedDomains);window.addEventListener("storage",D.onStorage(f)),window.addEventListener("message",(e=Gn,n=a,i={},function(t){window.clearTimeout(r);var o=Dn(t,n);Object.assign(i,o),r=window.setTimeout((function(){e(i),i={}}),20)}));var s=c.get("subscriptionDomain"),u=c.get("channel"),l=D.getJSON("tags");return Promise.all([u,s]).then((function(t){var e=qn(t,2),n=e[0],r=e[1];if(r&&(0,o.Z)("[secure-bridge] Subscription domain found in secure-bridge: %s",r),f({channel:n,tags:l,subscriptionDomain:r}),n)return Zn().then((function(t){t&&(D.setJSON("session",t),f({session:t}))}))}));function f(t){window.parent.postMessage(Fn(t),a)}}})}catch(t){t instanceof ReferenceError&&self&&(self.uaSetup={worker:function(t,e){void 0===e&&(e={}),xn(e),t.addEventListener("message",(function(e){(function(t){var e=Object.values(Ur);return t.data&&e.includes(t.data.command)})(e)&&qr(t,e)})),t.addEventListener("push",(function(e){return ui(t,e)})),t.addEventListener("notificationclick",(function(e){return ii(t,e)})),t.addEventListener("activate",(function(e){return function(t,e){e.waitUntil(Promise.all([t.clients.claim(),kr(t)]))}(t,e)})),t.addEventListener("pushsubscriptionchange",(function(e){return function(t,e){return ci(this,void 0,void 0,(function(){var e,n,r;return li(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,Xn(t.registration)];case 1:return e=i.sent(),[4,Wr()];case 2:return(n=i.sent())?[2,fi(e,n)]:[2];case 3:return r=i.sent(),(0,o.Z)("Error in changeEventHandler: %s",r),[3,4];case 4:return[2]}}))}))}(t)}))}})}}()}();